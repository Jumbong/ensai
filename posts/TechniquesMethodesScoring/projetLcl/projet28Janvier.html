<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Menu - Evolution du Taux de variable cible</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../ensai.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Menu</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/junior-jumbong-258330211/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Jumbong"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">Github</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Evolution du Taux de variable cible</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Evolution du Taux de variable cible</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Ensai 3A</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/ValueAtRisk/ValueAtRisk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Value at Risk</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/MasteringFinancialData/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mastering Financial Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/obligation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Courbe de taux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/MarketFinance/schiller.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sharpes Ratio</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">climat</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/ClimateScenario/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scénarios climatiques</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/ClimatMeteo/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Différence entre climat et météo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/NotionCle/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notions clés pour comprendre le changement climatique</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div id="e167cd55-8a21-4c03-b9af-0660985cec72" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install sas7bdat</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install chardet</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install matplotlib</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install seaborn</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install scipy</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install scikit<span class="op">-</span>learn</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install statsmodels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting sas7bdat
  Downloading sas7bdat-2.2.3.tar.gz (16 kB)
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: six&gt;=1.8.0 in c:\users\johns\appdata\roaming\python\python312\site-packages (from sas7bdat) (1.16.0)
Building wheels for collected packages: sas7bdat
  Building wheel for sas7bdat (setup.py): started
  Building wheel for sas7bdat (setup.py): finished with status 'done'
  Created wheel for sas7bdat: filename=sas7bdat-2.2.3-py3-none-any.whl size=16337 sha256=4c285e4c5863af9f1bb92b8127303fd0b91313798a6d2e0c8d34aa619ea89604
  Stored in directory: c:\users\johns\appdata\local\pip\cache\wheels\d0\47\4e\8519b82120c27c15b46d95fec6c63fed185467a9441dcb4183
Successfully built sas7bdat
Installing collected packages: sas7bdat
Successfully installed sas7bdat-2.2.3
Requirement already satisfied: pandas in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (2.1.4)
Requirement already satisfied: numpy&lt;2,&gt;=1.26.0 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas) (1.26.4)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in c:\users\johns\appdata\roaming\python\python312\site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas) (2024.1)
Requirement already satisfied: six&gt;=1.5 in c:\users\johns\appdata\roaming\python\python312\site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.16.0)
Requirement already satisfied: chardet in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (4.0.0)
Requirement already satisfied: matplotlib in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (3.8.3)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (4.49.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (1.4.5)
Requirement already satisfied: numpy&lt;2,&gt;=1.21 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (1.26.4)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\johns\appdata\roaming\python\python312\site-packages (from matplotlib) (23.2)
Requirement already satisfied: pillow&gt;=8 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (10.2.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib) (3.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\johns\appdata\roaming\python\python312\site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six&gt;=1.5 in c:\users\johns\appdata\roaming\python\python312\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.16.0)
Requirement already satisfied: seaborn in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (0.13.2)
Requirement already satisfied: numpy!=1.24.0,&gt;=1.20 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from seaborn) (1.26.4)
Requirement already satisfied: pandas&gt;=1.2 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from seaborn) (2.1.4)
Requirement already satisfied: matplotlib!=3.6.1,&gt;=3.4 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from seaborn) (3.8.3)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (4.49.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\johns\appdata\roaming\python\python312\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (23.2)
Requirement already satisfied: pillow&gt;=8 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (10.2.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (3.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\johns\appdata\roaming\python\python312\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas&gt;=1.2-&gt;seaborn) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas&gt;=1.2-&gt;seaborn) (2024.1)
Requirement already satisfied: six&gt;=1.5 in c:\users\johns\appdata\roaming\python\python312\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.16.0)
Requirement already satisfied: scipy in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (1.11.4)
Requirement already satisfied: numpy&lt;1.28.0,&gt;=1.21.6 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from scipy) (1.26.4)
Collecting scikit-learn
  Downloading scikit_learn-1.4.1.post1-cp312-cp312-win_amd64.whl.metadata (11 kB)
Requirement already satisfied: numpy&lt;2.0,&gt;=1.19.5 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from scikit-learn) (1.26.4)
Requirement already satisfied: scipy&gt;=1.6.0 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from scikit-learn) (1.11.4)
Collecting joblib&gt;=1.2.0 (from scikit-learn)
  Downloading joblib-1.4.0-py3-none-any.whl.metadata (5.4 kB)
Collecting threadpoolctl&gt;=2.0.0 (from scikit-learn)
  Using cached threadpoolctl-3.4.0-py3-none-any.whl.metadata (13 kB)
Downloading scikit_learn-1.4.1.post1-cp312-cp312-win_amd64.whl (10.6 MB)
   ---------------------------------------- 0.0/10.6 MB ? eta -:--:--
   ---------------------------------------- 0.0/10.6 MB 1.3 MB/s eta 0:00:09
   - -------------------------------------- 0.5/10.6 MB 7.9 MB/s eta 0:00:02
   ----- ---------------------------------- 1.4/10.6 MB 12.7 MB/s eta 0:00:01
   -------------- ------------------------- 3.8/10.6 MB 24.5 MB/s eta 0:00:01
   --------------------------- ------------ 7.4/10.6 MB 39.6 MB/s eta 0:00:01
   ---------------------------------------  10.6/10.6 MB 54.4 MB/s eta 0:00:01
   ---------------------------------------- 10.6/10.6 MB 46.7 MB/s eta 0:00:00
Downloading joblib-1.4.0-py3-none-any.whl (301 kB)
   ---------------------------------------- 0.0/301.2 kB ? eta -:--:--
   --------------------------------------- 301.2/301.2 kB 18.2 MB/s eta 0:00:00
Using cached threadpoolctl-3.4.0-py3-none-any.whl (17 kB)
Installing collected packages: threadpoolctl, joblib, scikit-learn
Successfully installed joblib-1.4.0 scikit-learn-1.4.1.post1 threadpoolctl-3.4.0
Requirement already satisfied: statsmodels in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (0.14.1)
Requirement already satisfied: numpy&lt;2,&gt;=1.18 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from statsmodels) (1.26.4)
Requirement already satisfied: scipy!=1.9.2,&gt;=1.4 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from statsmodels) (1.11.4)
Requirement already satisfied: pandas!=2.1.0,&gt;=1.0 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from statsmodels) (2.1.4)
Requirement already satisfied: patsy&gt;=0.5.4 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from statsmodels) (0.5.6)
Requirement already satisfied: packaging&gt;=21.3 in c:\users\johns\appdata\roaming\python\python312\site-packages (from statsmodels) (23.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in c:\users\johns\appdata\roaming\python\python312\site-packages (from pandas!=2.1.0,&gt;=1.0-&gt;statsmodels) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas!=2.1.0,&gt;=1.0-&gt;statsmodels) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\johns\appdata\local\programs\python\python312\lib\site-packages (from pandas!=2.1.0,&gt;=1.0-&gt;statsmodels) (2024.1)
Requirement already satisfied: six in c:\users\johns\appdata\roaming\python\python312\site-packages (from patsy&gt;=0.5.4-&gt;statsmodels) (1.16.0)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330
DEPRECATION: Loading egg at c:\users\johns\appdata\local\programs\python\python312\lib\site-packages\pyportfolio-1.0.1-py3.12.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation.. Discussion can be found at https://github.com/pypa/pip/issues/12330</code></pre>
</div>
</div>
<div id="4a84b9e5-96ae-4db0-a00c-d4b6fbee5197" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> chardet</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> percentile</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="17d51f2b-9208-4dfb-94b1-d3b9dad99a86" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>chemin_fichier_sas <span class="op">=</span> <span class="st">'base_finale_cible_1.sas7bdat'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_sas(chemin_fichier_sas, <span class="bu">format</span><span class="op">=</span><span class="st">'sas7bdat'</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.head())</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Erreur lors de la lecture du fichier SAS : </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       date cible_1  NUMTECPRS  Engagement_prorat   CODNAF2  \
0  202201.0    b'0'    17164.0            6689.74  b'8690D'   
1  202201.0    b'0'    35980.0           36711.62  b'8690E'   
2  202201.0    b'0'    43932.0            1127.50  b'4932Z'   
3  202201.0    b'0'    56910.0            1632.79  b'4781Z'   
4  202201.0    b'0'    60438.0              75.82  b'8690D'   

                  SEC_DER COULEUR_PART_M COULEUR_PART_MM3_M   AGE CODETAJUR  \
0     b'Pro lib sant\xe9'        b'Vert'       b'Vert_Vert'  58.0   b'1500'   
1     b'Pro lib sant\xe9'        b'Vert'       b'Vert_Vert'  60.0   b'1500'   
2              b'Artisan'        b'Vert'       b'Vert_Vert'  49.0   b'1300'   
3  b'Comm d\xe9tail alim'        b'Vert'       b'Vert_Vert'  52.0   b'1200'   
4     b'Pro lib sant\xe9'      b'Orange'   b'Orange_Orange'  38.0   b'1500'   

   ... Degra_couleur_IRPRO_mm1 INDDBLRLNPAR  INDRSKITDBDF  IRPRO_rouge_3dm  \
0  ...                   b' 0'         b'2'          b'0'             b'0'   
1  ...                   b' 0'         b'2'          b'0'             b'0'   
2  ...                   b' 0'         b'2'          b'0'             b'0'   
3  ...                   b' 0'         b'2'          b'0'             b'0'   
4  ...                   b'-1'         b'2'          b'0'             b'0'   

   NDB_12dm  NDB_6dm  NDB_3dm  TOP_SCI  classe_finale_NDB  NBRMMSANCCLI  
0      b'0'     b'0'     b'0'     b'0'              b' 4'         451.0  
1      b'0'     b'0'     b'0'     b'0'              b' 1'         468.0  
2      b'0'     b'0'     b'0'     b'0'              b' 2'         363.0  
3      b'0'     b'0'     b'0'     b'0'              b' 1'         300.0  
4      b'0'     b'0'     b'0'     b'0'              b' 8'         308.0  

[5 rows x 185 columns]</code></pre>
</div>
</div>
<div id="858b64b5-bd9c-4dd4-8431-4beeb141091d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lES colonnes sont encodées en bytes. Décodage</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> decode_bytes(val):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(val, <span class="bu">bytes</span>):  <span class="co"># Vérifie si la valeur est de type byte</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> val.decode(<span class="st">'utf-8'</span>)  <span class="co"># Tente de décoder en 'utf-8'</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">UnicodeDecodeError</span>:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> val.decode(<span class="st">'utf-8'</span>, errors<span class="op">=</span><span class="st">'ignore'</span>)  <span class="co"># Ignore les erreurs de décodage</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> val</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Appliquer cette fonction à toutes les colonnes de type object</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[<span class="bu">object</span>]):</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    df[col] <span class="op">=</span> df[col].<span class="bu">map</span>(decode_bytes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="58213011-0ab1-471e-ab9b-8bf8701819e3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Supposons que df est un array NumPy</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(df)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>date                 float64
cible_1               object
NUMTECPRS            float64
Engagement_prorat    float64
CODNAF2               object
                      ...   
NDB_6dm               object
NDB_3dm               object
TOP_SCI               object
classe_finale_NDB     object
NBRMMSANCCLI         float64
Length: 185, dtype: object</code></pre>
</div>
</div>
<div id="e2e0b9ee-e05b-4ecc-9e53-b30ee7e9d5ba" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'date'</span>].nunique())</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'date'</span>], <span class="bu">format</span> <span class="op">=</span> <span class="st">'%Y%m'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#dt.strftime('%Y-%m')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
<div id="bbed685d-b055-40bb-b86c-2885cc866f5c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#np.unique(df['date'])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>date                 datetime64[ns]
cible_1                      object
NUMTECPRS                   float64
Engagement_prorat           float64
CODNAF2                      object
                          ...      
NDB_6dm                      object
NDB_3dm                      object
TOP_SCI                      object
classe_finale_NDB            object
NBRMMSANCCLI                float64
Length: 185, dtype: object</code></pre>
</div>
</div>
<section id="evolution-du-taux-de-variable-cible" class="level1">
<h1>Evolution du Taux de variable cible</h1>
<div id="2c8c8e98-fc41-4d1e-b8b4-453db868a1fe" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'cible_1'</span>] <span class="op">=</span> df[<span class="st">'cible_1'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>taux_cible <span class="op">=</span> df.groupby(df[<span class="st">'date'</span>].dt.to_period(<span class="st">'M'</span>))[<span class="st">'cible_1'</span>].mean() <span class="co"># ou sum()</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracer le taux de la variable cible au fil du temps</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>taux_cible.plot(title<span class="op">=</span><span class="st">'Taux de la variable cible dans le temps'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Taux moyen de la variable cible'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,<span class="fl">0.1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="95d79c95-e57b-4cc8-b3e0-ca48ea96f72c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a> df_to_drop <span class="op">=</span> [<span class="st">"cible_2"</span>,<span class="st">"cible_3"</span>]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a> new_df <span class="op">=</span> df.drop(columns<span class="op">=</span>df_to_drop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="459b795b-6faf-46bd-a1f1-e7a0355c14fe" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation de la variable cible en variables </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">'cible_1'</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> new_df[[target_column]].copy().astype(<span class="st">"category"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cible_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">596050</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">596051</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">596052</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">596053</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">596054</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>596055 rows × 1 columns</p>
</div>
</div>
</div>
<div id="5897d439-5e5b-4bb3-a34b-c8e6893e799a" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>target.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>cible_1
0          567790
1           28265
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="08d85705-b182-4f8e-969b-133e8de571d4" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#base_travail = new_df.drop([target_column], axis=1).copy()</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>base_travail <span class="op">=</span> new_df.copy()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>base_travail.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">cible_1</th>
<th data-quarto-table-cell-role="th">NUMTECPRS</th>
<th data-quarto-table-cell-role="th">Engagement_prorat</th>
<th data-quarto-table-cell-role="th">CODNAF2</th>
<th data-quarto-table-cell-role="th">SEC_DER</th>
<th data-quarto-table-cell-role="th">COULEUR_PART_M</th>
<th data-quarto-table-cell-role="th">COULEUR_PART_MM3_M</th>
<th data-quarto-table-cell-role="th">AGE</th>
<th data-quarto-table-cell-role="th">CODETAJUR</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Degra_couleur_IRPRO_mm1</th>
<th data-quarto-table-cell-role="th">INDDBLRLNPAR</th>
<th data-quarto-table-cell-role="th">INDRSKITDBDF</th>
<th data-quarto-table-cell-role="th">IRPRO_rouge_3dm</th>
<th data-quarto-table-cell-role="th">NDB_12dm</th>
<th data-quarto-table-cell-role="th">NDB_6dm</th>
<th data-quarto-table-cell-role="th">NDB_3dm</th>
<th data-quarto-table-cell-role="th">TOP_SCI</th>
<th data-quarto-table-cell-role="th">classe_finale_NDB</th>
<th data-quarto-table-cell-role="th">NBRMMSANCCLI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2022-01-01</td>
<td>0</td>
<td>17164.0</td>
<td>6689.74</td>
<td>8690D</td>
<td>Pro lib sant</td>
<td>Vert</td>
<td>Vert_Vert</td>
<td>58.0</td>
<td>1500</td>
<td>...</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>451.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2022-01-01</td>
<td>0</td>
<td>35980.0</td>
<td>36711.62</td>
<td>8690E</td>
<td>Pro lib sant</td>
<td>Vert</td>
<td>Vert_Vert</td>
<td>60.0</td>
<td>1500</td>
<td>...</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>468.0</td>
</tr>
</tbody>
</table>

<p>2 rows × 183 columns</p>
</div>
</div>
</div>
<div id="a9e57a79" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>base_travail.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">cible_1</th>
<th data-quarto-table-cell-role="th">NUMTECPRS</th>
<th data-quarto-table-cell-role="th">Engagement_prorat</th>
<th data-quarto-table-cell-role="th">AGE</th>
<th data-quarto-table-cell-role="th">NBOPECAR</th>
<th data-quarto-table-cell-role="th">NBOPECARGLISS_M12</th>
<th data-quarto-table-cell-role="th">MNTOPECAR</th>
<th data-quarto-table-cell-role="th">NBPMTCAR</th>
<th data-quarto-table-cell-role="th">NBPMTCARGLISS_M12</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">MNTECRDBT_rel_mm12</th>
<th data-quarto-table-cell-role="th">NBPLV_abs_mm12</th>
<th data-quarto-table-cell-role="th">MNTPLV_abs_mm12</th>
<th data-quarto-table-cell-role="th">MNTPLV_rel_mm12</th>
<th data-quarto-table-cell-role="th">MNTTOTMVTAFF_abs_mm12</th>
<th data-quarto-table-cell-role="th">MNTTOTMVTAFF_rel_mm12</th>
<th data-quarto-table-cell-role="th">NB_SALARIES_abs_mm12</th>
<th data-quarto-table-cell-role="th">CATTCEUR_abs_mm12</th>
<th data-quarto-table-cell-role="th">EVOL_NB_SALARIE</th>
<th data-quarto-table-cell-role="th">NBRMMSANCCLI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>596055</td>
<td>596055.000000</td>
<td>5.960550e+05</td>
<td>5.960550e+05</td>
<td>176362.000000</td>
<td>596042.000000</td>
<td>596042.000000</td>
<td>596042.000000</td>
<td>596042.000000</td>
<td>596042.000000</td>
<td>...</td>
<td>527003.000000</td>
<td>539998.000000</td>
<td>5.399980e+05</td>
<td>462609.000000</td>
<td>5.399980e+05</td>
<td>4.650860e+05</td>
<td>460228.000000</td>
<td>404477.000000</td>
<td>460228.000000</td>
<td>596000.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2022-06-14 06:33:49.089261568</td>
<td>0.047420</td>
<td>6.657878e+10</td>
<td>8.857375e+04</td>
<td>49.478845</td>
<td>12.737780</td>
<td>147.844815</td>
<td>1323.022782</td>
<td>12.303423</td>
<td>142.622399</td>
<td>...</td>
<td>17.086667</td>
<td>0.940618</td>
<td>-1.208382e+03</td>
<td>9.514179</td>
<td>2.255714e+03</td>
<td>7.603675e+01</td>
<td>0.241632</td>
<td>-12.461831</td>
<td>0.241632</td>
<td>145.162705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2022-01-01 00:00:00</td>
<td>0.000000</td>
<td>9.100000e+02</td>
<td>1.736364e-01</td>
<td>18.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>-0.999996</td>
<td>-881.000000</td>
<td>-1.596642e+06</td>
<td>-0.999998</td>
<td>-2.482887e+08</td>
<td>-1.516897e+02</td>
<td>-1912.000000</td>
<td>-740952.000000</td>
<td>-1912.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2022-03-01 00:00:00</td>
<td>0.000000</td>
<td>3.090370e+10</td>
<td>3.039770e+03</td>
<td>40.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>-0.260173</td>
<td>-1.000000</td>
<td>-1.289785e+03</td>
<td>-0.110536</td>
<td>-3.360000e+03</td>
<td>-2.759760e-01</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>40.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2022-06-01 00:00:00</td>
<td>0.000000</td>
<td>6.430684e+10</td>
<td>2.052365e+04</td>
<td>50.000000</td>
<td>5.000000</td>
<td>76.000000</td>
<td>360.725000</td>
<td>5.000000</td>
<td>73.000000</td>
<td>...</td>
<td>0.020260</td>
<td>0.000000</td>
<td>-6.641000e+01</td>
<td>0.115977</td>
<td>0.000000e+00</td>
<td>1.499163e-02</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>98.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2022-09-01 00:00:00</td>
<td>0.000000</td>
<td>9.925173e+10</td>
<td>7.269348e+04</td>
<td>59.000000</td>
<td>17.000000</td>
<td>206.000000</td>
<td>1568.927500</td>
<td>17.000000</td>
<td>199.000000</td>
<td>...</td>
<td>0.478994</td>
<td>2.000000</td>
<td>1.212075e+02</td>
<td>0.686319</td>
<td>5.128438e+03</td>
<td>4.864432e-01</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>206.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2022-12-01 00:00:00</td>
<td>1.000000</td>
<td>1.343995e+11</td>
<td>4.007516e+07</td>
<td>98.000000</td>
<td>844.000000</td>
<td>9034.000000</td>
<td>160732.980000</td>
<td>832.000000</td>
<td>9029.000000</td>
<td>...</td>
<td>327069.285366</td>
<td>231.000000</td>
<td>2.844443e+06</td>
<td>290358.133333</td>
<td>4.008643e+07</td>
<td>5.784573e+06</td>
<td>3003.000000</td>
<td>860657.000000</td>
<td>3003.000000</td>
<td>875.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>0.212536</td>
<td>3.899386e+10</td>
<td>3.195101e+05</td>
<td>12.331494</td>
<td>20.798193</td>
<td>218.133552</td>
<td>2736.134063</td>
<td>20.197252</td>
<td>211.653229</td>
<td>...</td>
<td>960.194835</td>
<td>5.553490</td>
<td>1.467715e+04</td>
<td>621.065314</td>
<td>3.578929e+05</td>
<td>1.174079e+04</td>
<td>10.413646</td>
<td>2406.758717</td>
<td>10.413646</td>
<td>138.796024</td>
</tr>
</tbody>
</table>

<p>8 rows × 154 columns</p>
</div>
</div>
</div>
<div id="045951c5-199c-40c2-8ca0-2086b1ac9308" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def find_columns_with_few_unique_values(df, max_unique_values=20):</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     Identifie les colonnes dans le DataFrame ayant moins de 'max_unique_values' valeurs distinctes</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     et dont les noms ne commencent pas par 'NB' ni 'CATTCEUR'.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     :param df: DataFrame Pandas.</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     :param max_unique_values: Le nombre maximum de valeurs distinctes autorisées.</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     :return: Liste des colonnes correspondantes.</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     return [col for col in df.columns if df[col].nunique() &lt; max_unique_values and not col.startswith('NB') and not col.startswith('CATTCEUR')]</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # CATTCEUR : chiffre d'affaires, toutes les variables commençant par NB sont catégorielles.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2852d2a0-4050-418b-963a-623ffa524e02" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def find_non_numerical_variable(df):</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     Identifie les colonnes non nuémriques dans un dataframe.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     :param df: Dataframe pandas</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     return [col for col in df.columns if df[col].dtypes != float]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1cc6e738-9d9e-4b78-84db-bd60b543fa14" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>categorical_columns<span class="op">=</span>[col <span class="cf">for</span> col <span class="kw">in</span> base_travail.columns <span class="cf">if</span> col.startswith(<span class="st">'CHR_USAGE'</span>) <span class="kw">or</span> col.startswith(<span class="st">'CODACVPRO'</span>) <span class="kw">or</span> col.startswith(<span class="st">'CODETAJUR'</span>) <span class="kw">or</span> col.startswith(<span class="st">'CODNAF2'</span>) <span class="kw">or</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                     col.startswith(<span class="st">'CODTYPPRS'</span>) <span class="kw">or</span> col.startswith(<span class="st">'COULEUR_IRPRO'</span>) <span class="kw">or</span> col.startswith(<span class="st">'COULEUR_PART_M'</span>) <span class="kw">or</span> col.startswith(<span class="st">'Degra_IRPRO'</span>) <span class="kw">or</span> col.startswith(<span class="st">'Degra_couleur'</span>) <span class="kw">or</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                     col.startswith(<span class="st">'INDDBLRLNPAR'</span>) <span class="kw">or</span> col.startswith(<span class="st">'INDRSKITDBDF'</span>) <span class="kw">or</span> col.startswith(<span class="st">'IRPRO_rouge_3dm'</span>) <span class="kw">or</span> col.startswith(<span class="st">'NDB'</span>) <span class="kw">or</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                     col.startswith(<span class="st">'SEC_DER'</span>) <span class="kw">or</span> col.startswith(<span class="st">'TOP_SCI'</span>) <span class="kw">or</span> col.startswith(<span class="st">'Type_fdc_dm'</span>) <span class="kw">or</span> col.startswith(<span class="st">'classe_finale_NDB'</span>)]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#categorical_columns = find_non_numerical_variable(base_travail)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>numerical_columns <span class="op">=</span> base_travail.drop(columns<span class="op">=</span> categorical_columns<span class="op">+</span>[<span class="st">'cible_1'</span>,<span class="st">'date'</span>,<span class="st">'NBJ_ARR'</span>, <span class="st">'LIBCSPCMP'</span>]).columns</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(numerical_columns)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>numerical_columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Index(['NUMTECPRS', 'Engagement_prorat', 'AGE', 'NBOPECAR',
       'NBOPECARGLISS_M12', 'MNTOPECAR', 'NBPMTCAR', 'NBPMTCARGLISS_M12',
       'MNTPMTCAR', 'NBRETCAR',
       ...
       'MNTECRDBT_rel_mm12', 'NBPLV_abs_mm12', 'MNTPLV_abs_mm12',
       'MNTPLV_rel_mm12', 'MNTTOTMVTAFF_abs_mm12', 'MNTTOTMVTAFF_rel_mm12',
       'NB_SALARIES_abs_mm12', 'CATTCEUR_abs_mm12', 'EVOL_NB_SALARIE',
       'NBRMMSANCCLI'],
      dtype='object', length=150)</code></pre>
</div>
</div>
</section>
<section id="echatillonnage-train-test" class="level1">
<h1>Echatillonnage train-test</h1>
<div id="5587ba3b" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> base_travail.drop(columns <span class="op">=</span> [<span class="st">'cible_1'</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>X[<span class="st">'stratify_col'</span>] <span class="op">=</span> base_travail[<span class="st">'cible_1'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> base_travail[<span class="st">'date'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Split train-test stratifié en utilisant la colonne combinée</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    X,  <span class="co"># Les features incluant la date si elle est utilisée comme feature</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    target,                 <span class="co"># La variable cible</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    stratify<span class="op">=</span>X[<span class="st">'stratify_col'</span>],  <span class="co"># La nouvelle colonne pour la stratification</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.3</span>,                <span class="co"># La proportion de l'ensemble de test</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>               <span class="co"># La graine pour la reproductibilité</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Vous pouvez ensuite supprimer la colonne 'stratify_col' si elle n'est pas nécessaire pour l'entraînement</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> X_train.drop([<span class="st">'stratify_col'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test.drop([<span class="st">'stratify_col'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ac385079" class="cell" data-scrolled="true" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>base_travail <span class="op">=</span> X_train</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>base_travail[<span class="st">'cible_1'</span>] <span class="op">=</span> y_train</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>base_travail</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">NUMTECPRS</th>
<th data-quarto-table-cell-role="th">Engagement_prorat</th>
<th data-quarto-table-cell-role="th">CODNAF2</th>
<th data-quarto-table-cell-role="th">SEC_DER</th>
<th data-quarto-table-cell-role="th">COULEUR_PART_M</th>
<th data-quarto-table-cell-role="th">COULEUR_PART_MM3_M</th>
<th data-quarto-table-cell-role="th">AGE</th>
<th data-quarto-table-cell-role="th">CODETAJUR</th>
<th data-quarto-table-cell-role="th">CODTYPPRS</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">INDDBLRLNPAR</th>
<th data-quarto-table-cell-role="th">INDRSKITDBDF</th>
<th data-quarto-table-cell-role="th">IRPRO_rouge_3dm</th>
<th data-quarto-table-cell-role="th">NDB_12dm</th>
<th data-quarto-table-cell-role="th">NDB_6dm</th>
<th data-quarto-table-cell-role="th">NDB_3dm</th>
<th data-quarto-table-cell-role="th">TOP_SCI</th>
<th data-quarto-table-cell-role="th">classe_finale_NDB</th>
<th data-quarto-table-cell-role="th">NBRMMSANCCLI</th>
<th data-quarto-table-cell-role="th">cible_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">527714</td>
<td>2022-11-01</td>
<td>8.400287e+10</td>
<td>22138.04</td>
<td>8121Z</td>
<td>Comm dtail non alim</td>
<td>Vert</td>
<td>Vert_Vert</td>
<td>61.0</td>
<td>1300</td>
<td>EI</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>353.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">324008</td>
<td>2022-07-01</td>
<td>4.992791e+10</td>
<td>103262.02</td>
<td>4690Z</td>
<td>Comm Gros non alim</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>5499</td>
<td>PM</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>148.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">464966</td>
<td>2022-10-01</td>
<td>4.200002e+10</td>
<td>151.98</td>
<td>8621Z</td>
<td>Pro lib sant</td>
<td>Vert</td>
<td>Vert_Vert</td>
<td>45.0</td>
<td>1500</td>
<td>EI</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>369.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136481</td>
<td>2022-03-01</td>
<td>9.252799e+10</td>
<td>31713.86</td>
<td>5610A</td>
<td>CHR</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>5499</td>
<td>PM</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>87.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">113310</td>
<td>2022-03-01</td>
<td>2.814150e+10</td>
<td>145069.18</td>
<td>6420Z</td>
<td>transport</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>5710</td>
<td>PM</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>33.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">370799</td>
<td>2022-08-01</td>
<td>4.352494e+10</td>
<td>89082.12</td>
<td>6820B</td>
<td>S C I</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>6540</td>
<td>PM</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>5</td>
<td>47.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3560</td>
<td>2022-01-01</td>
<td>1.400468e+10</td>
<td>45553.37</td>
<td>6420Z</td>
<td>transport</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>5499</td>
<td>PM</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>672.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">451641</td>
<td>2022-10-01</td>
<td>6.936990e+08</td>
<td>38600.85</td>
<td>5610A</td>
<td>CHR</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>5499</td>
<td>PM</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>21.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">241106</td>
<td>2022-05-01</td>
<td>1.058165e+11</td>
<td>3379.29</td>
<td>8690E</td>
<td>Pro lib sant</td>
<td>Vert</td>
<td>Vert_Vert</td>
<td>67.0</td>
<td>1500</td>
<td>EI</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>107.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">145189</td>
<td>2022-03-01</td>
<td>1.190046e+11</td>
<td>25014.45</td>
<td>4399C</td>
<td>Artisan</td>
<td>NC</td>
<td>NC_NC</td>
<td>NaN</td>
<td>5499</td>
<td>PM</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>326.0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>417238 rows × 183 columns</p>
</div>
</div>
</div>
<div id="e5c74d5e-020d-4f6e-96cf-754fb1896b38" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>X_train[[<span class="st">'NBJDEB_NA_mm3'</span>, <span class="st">'NBJ_ARR_6dm'</span>,<span class="st">'NBJ_ARR_12dm'</span>, <span class="st">'DEPASSEMENT_6dm'</span>]].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NBJDEB_NA_mm3</th>
<th data-quarto-table-cell-role="th">NBJ_ARR_6dm</th>
<th data-quarto-table-cell-role="th">NBJ_ARR_12dm</th>
<th data-quarto-table-cell-role="th">DEPASSEMENT_6dm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>409013.000000</td>
<td>414952.000000</td>
<td>414957.000000</td>
<td>414972.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>4.325811</td>
<td>1.649420</td>
<td>2.657124</td>
<td>334.392676</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>13.264120</td>
<td>12.846556</td>
<td>17.603137</td>
<td>4548.158671</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>92.000000</td>
<td>1185.000000</td>
<td>1185.000000</td>
<td>922783.240000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="imputation-des-valeurs-manquantes-des-colonnes-numériques" class="level1">
<h1>Imputation des valeurs manquantes des colonnes numériques</h1>
<div id="819a67c7-832d-4741-969b-0b0cf5b75b78" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un imputer qui remplace les valeurs manquantes par la médiane de la colonne</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ceci dependait du taux de risque</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">'median'</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>base_travail[numerical_columns] <span class="op">=</span> imputer.fit_transform(base_travail[numerical_columns])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="91d84734-18fe-46f9-aa3e-df82a862e8ba" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(categorical_columns)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>categorical_columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>['CODNAF2',
 'SEC_DER',
 'COULEUR_PART_M',
 'COULEUR_PART_MM3_M',
 'CODETAJUR',
 'CODTYPPRS',
 'Type_fdc_dm',
 'Degra_IRPRO_mm6',
 'CHR_USAGE_NDB_V1_4',
 'CHR_USAGE_mm1',
 'CHR_USAGE_mm3',
 'CHR_USAGE_mm6',
 'CODACVPRO',
 'COULEUR_IRPRO',
 'COULEUR_IRPRO_mm1',
 'Degra_IRPRO_1pt_par_2m',
 'Degra_IRPRO_2pt_par_2m',
 'Degra_IRPRO_continue_3dm',
 'Degra_IRPRO_mm1',
 'Degra_IRPRO_mm3',
 'Degra_couleur_IRPRO_mm1',
 'INDDBLRLNPAR',
 'INDRSKITDBDF',
 'IRPRO_rouge_3dm',
 'NDB_12dm',
 'NDB_6dm',
 'NDB_3dm',
 'TOP_SCI',
 'classe_finale_NDB']</code></pre>
</div>
</div>
<div id="81108e40-3020-4b8b-b5cb-afd570f7019f" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertion des colonnes en category</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    base_travail[col] <span class="op">=</span> base_travail[col].astype(<span class="st">'category'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( base_travail[col].dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category
category</code></pre>
</div>
</div>
<div id="d164be82-3197-49d4-a125-8afd8e097558" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>base_travail.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">NUMTECPRS</th>
<th data-quarto-table-cell-role="th">Engagement_prorat</th>
<th data-quarto-table-cell-role="th">AGE</th>
<th data-quarto-table-cell-role="th">NBOPECAR</th>
<th data-quarto-table-cell-role="th">NBOPECARGLISS_M12</th>
<th data-quarto-table-cell-role="th">MNTOPECAR</th>
<th data-quarto-table-cell-role="th">NBPMTCAR</th>
<th data-quarto-table-cell-role="th">NBPMTCARGLISS_M12</th>
<th data-quarto-table-cell-role="th">MNTPMTCAR</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">MNTECRDBT_rel_mm12</th>
<th data-quarto-table-cell-role="th">NBPLV_abs_mm12</th>
<th data-quarto-table-cell-role="th">MNTPLV_abs_mm12</th>
<th data-quarto-table-cell-role="th">MNTPLV_rel_mm12</th>
<th data-quarto-table-cell-role="th">MNTTOTMVTAFF_abs_mm12</th>
<th data-quarto-table-cell-role="th">MNTTOTMVTAFF_rel_mm12</th>
<th data-quarto-table-cell-role="th">NB_SALARIES_abs_mm12</th>
<th data-quarto-table-cell-role="th">CATTCEUR_abs_mm12</th>
<th data-quarto-table-cell-role="th">EVOL_NB_SALARIE</th>
<th data-quarto-table-cell-role="th">NBRMMSANCCLI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>417238</td>
<td>4.172380e+05</td>
<td>4.172380e+05</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>...</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>4.172380e+05</td>
<td>417238.000000</td>
<td>4.172380e+05</td>
<td>4.172380e+05</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
<td>417238.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2022-06-14 06:35:32.779852032</td>
<td>6.657215e+10</td>
<td>8.828549e+04</td>
<td>49.844640</td>
<td>12.723903</td>
<td>147.597295</td>
<td>1322.522097</td>
<td>12.289130</td>
<td>142.382808</td>
<td>1260.104743</td>
<td>...</td>
<td>15.398514</td>
<td>0.850589</td>
<td>-1.110954e+03</td>
<td>7.908928</td>
<td>2.066443e+03</td>
<td>4.004353e+01</td>
<td>0.185721</td>
<td>-10.280849</td>
<td>0.185721</td>
<td>145.169445</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2022-01-01 00:00:00</td>
<td>9.100000e+02</td>
<td>1.736364e-01</td>
<td>18.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>-0.999996</td>
<td>-879.000000</td>
<td>-1.596642e+06</td>
<td>-0.999998</td>
<td>-2.482887e+08</td>
<td>-1.203245e+02</td>
<td>-1912.000000</td>
<td>-740952.000000</td>
<td>-1912.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2022-03-01 00:00:00</td>
<td>3.091303e+10</td>
<td>3.035210e+03</td>
<td>50.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>-0.209107</td>
<td>0.000000</td>
<td>-1.058997e+03</td>
<td>-0.020838</td>
<td>-2.562795e+03</td>
<td>-1.664659e-01</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>40.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2022-06-01 00:00:00</td>
<td>6.430664e+10</td>
<td>2.052731e+04</td>
<td>50.000000</td>
<td>5.000000</td>
<td>76.000000</td>
<td>359.970000</td>
<td>5.000000</td>
<td>73.000000</td>
<td>331.200000</td>
<td>...</td>
<td>0.019695</td>
<td>0.000000</td>
<td>-6.736000e+01</td>
<td>0.117025</td>
<td>0.000000e+00</td>
<td>1.503781e-02</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>98.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2022-09-01 00:00:00</td>
<td>9.922971e+10</td>
<td>7.238768e+04</td>
<td>50.000000</td>
<td>17.000000</td>
<td>205.000000</td>
<td>1567.412500</td>
<td>17.000000</td>
<td>198.000000</td>
<td>1473.222500</td>
<td>...</td>
<td>0.382677</td>
<td>2.000000</td>
<td>5.196750e+01</td>
<td>0.436767</td>
<td>4.069660e+03</td>
<td>2.909729e-01</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>206.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2022-12-01 00:00:00</td>
<td>1.343995e+11</td>
<td>4.007506e+07</td>
<td>98.000000</td>
<td>844.000000</td>
<td>9034.000000</td>
<td>160732.980000</td>
<td>832.000000</td>
<td>9029.000000</td>
<td>160732.980000</td>
<td>...</td>
<td>327069.285366</td>
<td>231.000000</td>
<td>2.844443e+06</td>
<td>290358.133333</td>
<td>4.008643e+07</td>
<td>2.202849e+06</td>
<td>1866.000000</td>
<td>253731.000000</td>
<td>1866.000000</td>
<td>875.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>3.899443e+10</td>
<td>3.193455e+05</td>
<td>6.717277</td>
<td>20.720898</td>
<td>216.774480</td>
<td>2744.399745</td>
<td>20.121102</td>
<td>210.277903</td>
<td>2670.991067</td>
<td>...</td>
<td>908.137720</td>
<td>5.285212</td>
<td>1.388503e+04</td>
<td>639.334207</td>
<td>3.967826e+05</td>
<td>4.821527e+03</td>
<td>9.088657</td>
<td>1808.822637</td>
<td>9.088657</td>
<td>138.842329</td>
</tr>
</tbody>
</table>

<p>8 rows × 152 columns</p>
</div>
</div>
</div>
<div id="6ebe14ec-253d-4b57-be07-7b6cfd9f241a" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chi_squared_test(df, target_variable, categorical_variables):</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cat_var <span class="kw">in</span> categorical_variables:</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Création d'un tableau de contingence</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        contingency_table <span class="op">=</span> pd.crosstab(target_variable, df[cat_var])</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Test du khi-deux</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        chi2, p, dof, expected <span class="op">=</span> chi2_contingency(contingency_table)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calcul du T de Tschuprow</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calcul de T de Tschuprow</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        N <span class="op">=</span> np.<span class="bu">sum</span>(contingency_table.values)  <span class="co"># Taille totale de l'échantillon</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        r, c <span class="op">=</span> contingency_table.shape       <span class="co"># Nombre de lignes et de colonnes</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        T <span class="op">=</span> np.sqrt(chi2 <span class="op">/</span> N <span class="op">/</span> np.sqrt((r <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> (c <span class="op">-</span> <span class="dv">1</span>)))</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        V <span class="op">=</span> np.sqrt(chi2 <span class="op">/</span> N <span class="op">/</span> <span class="bu">min</span>((r <span class="op">-</span> <span class="dv">1</span>), (c <span class="op">-</span> <span class="dv">1</span>)))</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Enregistrer les résultats</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        results.append({<span class="st">'Variable'</span>: cat_var, <span class="st">'Chi2'</span>: chi2, <span class="st">'p-value'</span>: p, <span class="st">'Tschuprow T'</span>: T, <span class="st">'V de Cramer'</span>: V})</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c9218a85-2961-4ed2-a531-f0e17a0593e7" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chi_squared_test(base_travail,target[target_column],categorical_columns).sort_values(by <span class="op">=</span><span class="st">'Chi2'</span>,ascending <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Chi2</th>
<th data-quarto-table-cell-role="th">p-value</th>
<th data-quarto-table-cell-role="th">Tschuprow T</th>
<th data-quarto-table-cell-role="th">V de Cramer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>classe_finale_NDB</td>
<td>54685.762</td>
<td>0.0</td>
<td>0.181</td>
<td>0.362</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>CHR_USAGE_NDB_V1_4</td>
<td>53787.923</td>
<td>0.0</td>
<td>0.207</td>
<td>0.359</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>CHR_USAGE_mm1</td>
<td>43069.728</td>
<td>0.0</td>
<td>0.173</td>
<td>0.321</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>COULEUR_IRPRO</td>
<td>39989.458</td>
<td>0.0</td>
<td>0.260</td>
<td>0.310</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>COULEUR_IRPRO_mm1</td>
<td>34267.063</td>
<td>0.0</td>
<td>0.218</td>
<td>0.287</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>CHR_USAGE_mm3</td>
<td>30482.445</td>
<td>0.0</td>
<td>0.145</td>
<td>0.270</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>CHR_USAGE_mm6</td>
<td>25343.021</td>
<td>0.0</td>
<td>0.132</td>
<td>0.246</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>IRPRO_rouge_3dm</td>
<td>24947.989</td>
<td>0.0</td>
<td>0.245</td>
<td>0.245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>Degra_IRPRO_mm3</td>
<td>10600.658</td>
<td>0.0</td>
<td>0.078</td>
<td>0.159</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Degra_IRPRO_mm6</td>
<td>9847.335</td>
<td>0.0</td>
<td>0.079</td>
<td>0.159</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CODNAF2</td>
<td>5633.832</td>
<td>0.0</td>
<td>0.023</td>
<td>0.116</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>Degra_IRPRO_mm1</td>
<td>5287.218</td>
<td>0.0</td>
<td>0.058</td>
<td>0.113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>NDB_12dm</td>
<td>4674.392</td>
<td>0.0</td>
<td>0.089</td>
<td>0.106</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>NDB_6dm</td>
<td>4117.491</td>
<td>0.0</td>
<td>0.084</td>
<td>0.099</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CODETAJUR</td>
<td>3639.674</td>
<td>0.0</td>
<td>0.028</td>
<td>0.093</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>INDRSKITDBDF</td>
<td>3304.329</td>
<td>0.0</td>
<td>0.075</td>
<td>0.089</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>Degra_IRPRO_continue_3dm</td>
<td>3242.105</td>
<td>0.0</td>
<td>0.088</td>
<td>0.088</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>COULEUR_PART_MM3_M</td>
<td>3219.717</td>
<td>0.0</td>
<td>0.039</td>
<td>0.088</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Degra_couleur_IRPRO_mm1</td>
<td>3176.408</td>
<td>0.0</td>
<td>0.058</td>
<td>0.087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>NDB_3dm</td>
<td>2864.856</td>
<td>0.0</td>
<td>0.070</td>
<td>0.083</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>COULEUR_PART_M</td>
<td>2811.626</td>
<td>0.0</td>
<td>0.058</td>
<td>0.082</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Type_fdc_dm</td>
<td>2069.356</td>
<td>0.0</td>
<td>0.054</td>
<td>0.070</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>SEC_DER</td>
<td>1909.384</td>
<td>0.0</td>
<td>0.033</td>
<td>0.068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>CODACVPRO</td>
<td>1242.779</td>
<td>0.0</td>
<td>0.020</td>
<td>0.055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>INDDBLRLNPAR</td>
<td>731.089</td>
<td>0.0</td>
<td>0.032</td>
<td>0.042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Degra_IRPRO_1pt_par_2m</td>
<td>602.333</td>
<td>0.0</td>
<td>0.038</td>
<td>0.038</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>CODTYPPRS</td>
<td>321.140</td>
<td>0.0</td>
<td>0.028</td>
<td>0.028</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>TOP_SCI</td>
<td>81.506</td>
<td>0.0</td>
<td>0.014</td>
<td>0.014</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Degra_IRPRO_2pt_par_2m</td>
<td>18.521</td>
<td>0.0</td>
<td>0.007</td>
<td>0.007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4e4e9c20-53de-4a5d-8f9f-dcaf3237b852" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>base_test_chi2<span class="op">=</span> chi_squared_test(base_travail,target[target_column],categorical_columns).sort_values(by <span class="op">=</span><span class="st">'Chi2'</span>,ascending <span class="op">=</span> <span class="va">True</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>plt.barh(base_test_chi2[<span class="st">'Variable'</span>], base_test_chi2[<span class="st">'Chi2'</span>])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez des étiquettes et un titre</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Statistique de Chi2'</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variable'</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variables catégorielles dépendantes de la variable cible'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Text(0.5, 1.0, 'Variables catégorielles dépendantes de la variable cible')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-28-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="8ee34418-171d-45de-8721-f6fb4e0da595" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kruskal</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#L'hypothèse nulle (H0) du test de Kruskal-Wallis est que les médianes de tous les groupes sont égales</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Il y'aura liaison entre la variable continue et la variable catégorielle avec X% de chance de </span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># se tromper si on rejette l'hypothèse nulle du test.</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kruskal_wallis_test(df, target_column, target,numerical_columns):</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Cette fonction permet de réaliser le test de Kruskal Wallis c'est dire comparer la distribution de un ou plusieurs </span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">        groupes indépendantes.</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">        params:</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">            - df : base de variables indépendantes </span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">            - target_column : nom de ma variable cible</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">            - target : variable cible</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">            - numerical_columns: ensemble de mes variables numériques.</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> [] <span class="co"># "liste de dictionnaires qui stockera mes résultats"</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    df[target_column] <span class="op">=</span> target </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> num_var <span class="kw">in</span> numerical_columns:</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Préparation des groupes</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> [group.dropna().values <span class="cf">for</span> name, group <span class="kw">in</span> df.groupby(target_column)[num_var]]</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Effectuer le test de Kruskal-Wallis</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>        H, p_value <span class="op">=</span> kruskal(<span class="op">*</span>groups)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Enregistrer les résultats</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        results.append({<span class="st">'Variable'</span>: num_var, <span class="st">'H-statistic'</span>: H, <span class="st">'p-value'</span>: p_value})</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convertir en DataFrame pour un affichage et une manipulation plus aisés</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    results_df <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results_df</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>Kw_test <span class="op">=</span> kruskal_wallis_test(base_travail, target_column, target,numerical_columns)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Kw_test)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Variable  H-statistic        p-value
0                NUMTECPRS     1.989063   1.584389e-01
1        Engagement_prorat  7450.828755   0.000000e+00
2                      AGE   105.251394   1.075830e-24
3                 NBOPECAR  4449.239770   0.000000e+00
4        NBOPECARGLISS_M12  1770.749359   0.000000e+00
..                     ...          ...            ...
145  MNTTOTMVTAFF_rel_mm12   678.306758  1.560084e-149
146   NB_SALARIES_abs_mm12    55.802025   8.014894e-14
147      CATTCEUR_abs_mm12     0.181140   6.703955e-01
148        EVOL_NB_SALARIE    55.802025   8.014894e-14
149           NBRMMSANCCLI  3084.278398   0.000000e+00

[150 rows x 3 columns]</code></pre>
</div>
</div>
<div id="870018c3-acbc-417c-8166-fe8732b7736d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Kw_test.sort_values(by <span class="op">=</span> <span class="st">"p-value"</span>, ascending<span class="op">=</span><span class="va">False</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">H-statistic</th>
<th data-quarto-table-cell-role="th">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">147</td>
<td>CATTCEUR_abs_mm12</td>
<td>0.181</td>
<td>0.670</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">127</td>
<td>CRTOC_IND_0301_abs_mm3</td>
<td>1.983</td>
<td>0.159</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NUMTECPRS</td>
<td>1.989</td>
<td>0.158</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">69</td>
<td>NB_RESTRU</td>
<td>4.002</td>
<td>0.045</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>CRTOD_CMT_IND_0036</td>
<td>5.507</td>
<td>0.019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>MNTTOTMVTAFFGLISS_M12_mm3</td>
<td>7597.307</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>MNTTOTMVTAFF_mm3</td>
<td>8168.178</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>MNTPLV_mm3</td>
<td>7176.757</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>NBPLV_mm3</td>
<td>6247.683</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>NBJDEPDP_mm3</td>
<td>10631.368</td>
<td>0.000</td>
</tr>
</tbody>
</table>

<p>150 rows × 3 columns</p>
</div>
</div>
</div>
<div id="b3b8a3a7-decd-41c9-ad92-de41fc8f553a" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>base_test_kw<span class="op">=</span> Kw_test.sort_values(by <span class="op">=</span> <span class="st">'H-statistic'</span>, ascending<span class="op">=</span><span class="va">True</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.barh(base_test_kw[<span class="st">'Variable'</span>][<span class="dv">2</span>:], base_test_kw[<span class="st">'H-statistic'</span>][<span class="dv">2</span>:])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez des étiquettes et un titre</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Statistique du test de Kruskal Wallis'</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variable'</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variables numériques dépendantes de la variable cible'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>Text(0.5, 1.0, 'Variables numériques dépendantes de la variable cible')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-31-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4474bff0-56fa-4da2-a9fe-63af415e4c86" class="cell" data-scrolled="true" data-execution_count="30">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vARIABLE numériques AVEC FAIBLE VARIANCE</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">from sklearn.feature_selection import VarianceThreshold</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">transform = VarianceThreshold()</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># transform the input data</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">X_sel = transform.fit_transform(base_travail[numerical_columns])</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">print(X_sel.shape)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>'\n# vARIABLE numériques AVEC FAIBLE VARIANCE\n\nfrom sklearn.feature_selection import VarianceThreshold\n\n\ntransform = VarianceThreshold()\n# transform the input data\nX_sel = transform.fit_transform(base_travail[numerical_columns])\nprint(X_sel.shape)\n'</code></pre>
</div>
</div>
<div id="1eff17f0-45c2-42a8-8618-6c03d0919a62" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># apply transform with each threshold</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">thresholds = np.arange(0.0, 0.55, 0.05)</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">results = list()</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">for t in thresholds:</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">    # define the transform</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">    transform = VarianceThreshold(threshold=t)</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">    # transform the input data</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">    X_sel = transform.fit_transform(base_travail[numerical_columns])</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">    # determine the number of input features</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">    n_features = X_sel.shape[1]</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">    print('&gt;Threshold=%.2f, Features=%d' % (t, n_features))</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">    # store the result</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">    results.append(n_features)</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>"\n# apply transform with each threshold\nthresholds = np.arange(0.0, 0.55, 0.05)\n\nresults = list()\nfor t in thresholds:\n    # define the transform\n    transform = VarianceThreshold(threshold=t)\n    # transform the input data\n    X_sel = transform.fit_transform(base_travail[numerical_columns])\n    # determine the number of input features\n    n_features = X_sel.shape[1]\n    print('&gt;Threshold=%.2f, Features=%d' % (t, n_features))\n    # store the result\n    results.append(n_features)\n"</code></pre>
</div>
</div>
<div id="9466d3ad-18cb-4fa9-968a-5ca3ddc40e14" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">varia_num_del=['NBOPECAR', 'NBOPECARGLISS_M12', 'MNTOPECAR', 'NBECRCRD_mm1',</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">       'NBECRCRD_mm3', 'NBECRDBT_mm1', 'NBECRDBT_mm3', 'NBCHQEMI',</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">       'NBPLV_mm1', 'NBPLV_mm3', 'MNTPLV_mm1', 'MNTPLV_mm3',</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTPLV_mm12', 'MNTTOTMVTAFFGLISS_M12_mm1',</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTTOTMVTAFFGLISS_M12_mm3', 'MNTTOTMVTAFF_mm1',</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTTOTMVTAFF_abs_mm1', 'MNTECRCRD_mm3', 'MNTTOTMVTAFF_mm12',</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTTOTMVTAFF_abs_mm12', 'NBJDEPDP_mm3', 'CATTCEUR_mm12',</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">       'LIGDEB_IND_0015', 'LIGDEB_IND_0015_mm3', 'LIGCRE_IND_0009_mm3',</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTECRDBT_abs_mm1', 'MNTECRDBT_abs_mm3', 'EVOL_NB_SALARIE',</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">       'NBPMTCARGLISS_M12', 'NBVIRPONRCP', 'NBECRCRD_mm12',</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTECRCRD_abs_mm3', 'NBECRDBT_mm12', 'MNTECRDBT_abs_mm12',</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">       'NBCHQEMIGLISS_M12', 'NBPLV_mm12', 'MNTECRDBT_mm3',</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">       'MNTECRDBT_mm12', 'MNTTOTMVTAFFGLISS_M12_mm12', 'DEPASSEMENT_12dm',</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">       'CRTOC_IND_0301', 'CRTOC_IND_0301_mm3', 'NB_SALARIES_mm12',</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co">       'CRTOC_IND_0164_abs_mm3']</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co">numerical_columns  = [col for col in numerical_columns if col not in varia_num_del]</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co">len(numerical_columns)</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>"\nvaria_num_del=['NBOPECAR', 'NBOPECARGLISS_M12', 'MNTOPECAR', 'NBECRCRD_mm1',\n       'NBECRCRD_mm3', 'NBECRDBT_mm1', 'NBECRDBT_mm3', 'NBCHQEMI',\n       'NBPLV_mm1', 'NBPLV_mm3', 'MNTPLV_mm1', 'MNTPLV_mm3',\n       'MNTPLV_mm12', 'MNTTOTMVTAFFGLISS_M12_mm1',\n       'MNTTOTMVTAFFGLISS_M12_mm3', 'MNTTOTMVTAFF_mm1',\n       'MNTTOTMVTAFF_abs_mm1', 'MNTECRCRD_mm3', 'MNTTOTMVTAFF_mm12',\n       'MNTTOTMVTAFF_abs_mm12', 'NBJDEPDP_mm3', 'CATTCEUR_mm12',\n       'LIGDEB_IND_0015', 'LIGDEB_IND_0015_mm3', 'LIGCRE_IND_0009_mm3',\n       'MNTECRDBT_abs_mm1', 'MNTECRDBT_abs_mm3', 'EVOL_NB_SALARIE',\n       'NBPMTCARGLISS_M12', 'NBVIRPONRCP', 'NBECRCRD_mm12',\n       'MNTECRCRD_abs_mm3', 'NBECRDBT_mm12', 'MNTECRDBT_abs_mm12',\n       'NBCHQEMIGLISS_M12', 'NBPLV_mm12', 'MNTECRDBT_mm3',\n       'MNTECRDBT_mm12', 'MNTTOTMVTAFFGLISS_M12_mm12', 'DEPASSEMENT_12dm',\n       'CRTOC_IND_0301', 'CRTOC_IND_0301_mm3', 'NB_SALARIES_mm12',\n       'CRTOC_IND_0164_abs_mm3']\nnumerical_columns  = [col for col in numerical_columns if col not in varia_num_del]\nlen(numerical_columns)\n"</code></pre>
</div>
</div>
<div id="977f6abc-700f-4d51-8102-73f0eb16eb47" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> outlier(data):</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    variables_non_numerique <span class="op">=</span> [] </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> data.columns:</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>            q25, q75 <span class="op">=</span> percentile(data[col], <span class="dv">25</span>), percentile(data[col], <span class="dv">75</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>            <span class="co"># define outliers</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>            iqr <span class="op">=</span> q75 <span class="op">-</span> q25</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># calculate the outlier cutoff</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            cut_off <span class="op">=</span> iqr <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            lower, upper <span class="op">=</span> q25 <span class="op">-</span> cut_off, q75 <span class="op">+</span> cut_off</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># identify outliers</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> data[col] <span class="cf">if</span> x <span class="op">&lt;</span> lower <span class="kw">or</span> x <span class="op">&gt;</span> upper]</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">TypeError</span>:</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>            variables_non_numerique.append(col)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(outliers)<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>            results.append(col)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(variables_non_numerique)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e43edc34-9a23-4b05-ada5-e69dac0057d7" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(outlier(base_travail[numerical_columns]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>['Engagement_prorat',
 'AGE',
 'NBOPECAR',
 'NBOPECARGLISS_M12',
 'MNTOPECAR',
 'NBPMTCAR',
 'NBPMTCARGLISS_M12',
 'MNTPMTCAR',
 'NBRETCAR',
 'NBRETCARGLISS_M12',
 'MNTRETCAR',
 'NBECRCRD',
 'MNTECRCRD',
 'NBECRDBT',
 'MNTECRDBT',
 'NBVIRPONEMI',
 'NBVIRPONEMIGLISS_M12',
 'MNTVIRPONEMI',
 'NBCHQEMI',
 'NBCHQEMIGLISS_M12',
 'MNTCHQEMI',
 'NBPLV',
 'MNTPLV',
 'NBVIRPONRCP',
 'MNTVIRPONRCP',
 'NBVIRPEREMI',
 'MNTVIRPEREMI',
 'MNTTOTMVTAFF',
 'MNTTOTMVTAFFGLISS_M12',
 'MNTECSCPTEPA',
 'NBECRCRD_mm1',
 'MNTECRCRD_mm1',
 'NBECRDBT_mm1',
 'MNTECRDBT_mm1',
 'NBPLV_mm1',
 'MNTPLV_mm1',
 'MNTTOTMVTAFF_mm1',
 'MNTTOTMVTAFFGLISS_M12_mm1',
 'NBECRCRD_mm3',
 'MNTECRCRD_mm3',
 'NBECRDBT_mm3',
 'MNTECRDBT_mm3',
 'NBPLV_mm3',
 'MNTPLV_mm3',
 'MNTTOTMVTAFF_mm3',
 'MNTTOTMVTAFFGLISS_M12_mm3',
 'NBECRCRD_mm12',
 'MNTECRCRD_mm12',
 'NBECRDBT_mm12',
 'MNTECRDBT_mm12',
 'NBPLV_mm12',
 'MNTPLV_mm12',
 'MNTTOTMVTAFF_mm12',
 'MNTTOTMVTAFFGLISS_M12_mm12',
 'IMPAYE',
 'DEPASSEMENT',
 'NBJ_ARR_mm1',
 'NBJ_ARR_mm12',
 'IMPAYE_3dm',
 'IMPAYE_6dm',
 'IMPAYE_12dm',
 'DEPASSEMENT_3dm',
 'DEPASSEMENT_6dm',
 'DEPASSEMENT_12dm',
 'NBJ_ARR_3dm',
 'NBJ_ARR_6dm',
 'NBJ_ARR_12dm',
 'NB_RR',
 'NB_RESTRU',
 'NB_RR_3dm',
 'NB_RR_6dm',
 'NB_RR_12dm',
 'NB_RESTRU_3dm',
 'NB_RESTRU_6dm',
 'NB_RESTRU_12dm',
 'NBJDEPDP',
 'PRORGL_FILLER_NUM07',
 'CRTOC_IND_0301',
 'NBJDEB_NA',
 'CRTOC_IND_0164',
 'CRTOD_CMT_IND_0036',
 'NBJDEPDP_mm3',
 'CRTOC_IND_0301_mm3',
 'NBJDEB_NA_mm3',
 'CRTOC_IND_0164_mm3',
 'CATTCEUR',
 'CATTCEUR_mm12',
 'NB_SALARIES',
 'NB_SALARIES_mm12',
 'Ratio_imp_eng',
 'NB_MOIS_AVEC_ARR_12dm',
 'LIGDEB_IND_0015',
 'NBJDEB_IND_0015',
 'LIGCRE_IND_0009',
 'LIGDEB_IND_0015_mm3',
 'NBJDEB_IND_0015_mm3',
 'LIGCRE_IND_0009_mm3',
 'NBECRCRD_abs_mm1',
 'NBECRCRD_rel_mm1',
 'MNTECRCRD_abs_mm1',
 'MNTECRCRD_rel_mm1',
 'NBECRDBT_abs_mm1',
 'NBECRDBT_rel_mm1',
 'MNTECRDBT_abs_mm1',
 'MNTECRDBT_rel_mm1',
 'NBPLV_abs_mm1',
 'MNTPLV_abs_mm1',
 'MNTPLV_rel_mm1',
 'MNTTOTMVTAFF_abs_mm1',
 'MNTTOTMVTAFF_rel_mm1',
 'NBECRCRD_abs_mm3',
 'NBECRCRD_rel_mm3',
 'MNTECRCRD_abs_mm3',
 'MNTECRCRD_rel_mm3',
 'NBECRDBT_abs_mm3',
 'NBECRDBT_rel_mm3',
 'MNTECRDBT_abs_mm3',
 'MNTECRDBT_rel_mm3',
 'NBPLV_abs_mm3',
 'MNTPLV_abs_mm3',
 'MNTPLV_rel_mm3',
 'MNTTOTMVTAFF_abs_mm3',
 'MNTTOTMVTAFF_rel_mm3',
 'NBJDEPDP_abs_mm3',
 'LIGDEB_IND_0015_abs_mm3',
 'NBJDEB_IND_0015_abs_mm3',
 'CRTOC_IND_0301_abs_mm3',
 'NBJDEB_NA_abs_mm3',
 'CRTOC_IND_0164_abs_mm3',
 'CRTOC_IND_0164_rel_mm3',
 'LIGCRE_IND_0009_abs_mm3',
 'LIGCRE_IND_0009_rel_mm3',
 'NBECRCRD_abs_mm12',
 'NBECRCRD_rel_mm12',
 'MNTECRCRD_abs_mm12',
 'MNTECRCRD_rel_mm12',
 'NBECRDBT_abs_mm12',
 'NBECRDBT_rel_mm12',
 'MNTECRDBT_abs_mm12',
 'MNTECRDBT_rel_mm12',
 'NBPLV_abs_mm12',
 'MNTPLV_abs_mm12',
 'MNTPLV_rel_mm12',
 'MNTTOTMVTAFF_abs_mm12',
 'MNTTOTMVTAFF_rel_mm12',
 'NB_SALARIES_abs_mm12',
 'CATTCEUR_abs_mm12',
 'EVOL_NB_SALARIE',
 'NBRMMSANCCLI']</code></pre>
</div>
</div>
<div id="c7c9399f-03a4-474a-867e-e1905cd88d1e" class="cell" data-scrolled="true" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> base_travail[categorical_columns].columns:</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">!=</span> <span class="st">'date'</span>:</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>       fig <span class="op">=</span> plt.figure()</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>       base_travail[x].value_counts(normalize<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       fig.suptitle(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-11.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-13.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-14.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-15.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-16.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-17.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-18.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-19.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-20.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-21.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-22.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-23.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-24.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-25.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-26.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-27.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-28.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-37-output-29.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="fc5794a8-7d2f-43cd-b244-0a8cf3c25186" class="cell" data-scrolled="true" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">import seaborn as sns</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">for col in (outlier(base_travail[numerical_columns])):</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">    sns.kdeplot(base_travail[col], shade=True)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">    plt.title('Histogramme et densité de probabilité de la variable')</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">    plt.xlabel(f' {col}')</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">    plt.ylabel('Fréquence/Densité')</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co">    plt.show()</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>"\nimport seaborn as sns\nfor col in (outlier(base_travail[numerical_columns])):\n    sns.kdeplot(base_travail[col], shade=True)\n    plt.title('Histogramme et densité de probabilité de la variable')\n    plt.xlabel(f' {col}')\n    plt.ylabel('Fréquence/Densité')\n    plt.show()\n"</code></pre>
</div>
</div>
<div id="cbc20c84-f6f9-4d4c-9f4d-3f54005c777e" class="cell" data-scrolled="true" data-execution_count="37">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">for col in (outlier(base_travail[numerical_columns])):</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">   fig = plt.figure()</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">   base_travail[col].hist()</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">   fig.suptitle(f'histo of {col}')</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">   plt.show()</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>"\nfor col in (outlier(base_travail[numerical_columns])):\n    \n   fig = plt.figure()\n   base_travail[col].hist()\n   fig.suptitle(f'histo of {col}')\n   plt.show()\n"</code></pre>
</div>
</div>
<div id="1c3f4a81-4545-4929-9731-7b123ab08cc3" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # summarize the number of rows with missing values for each column</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i =0</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for col in base_travail.columns:</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     # count number of rows with missing values</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     n_miss = base_travail[[col]].isnull().sum()</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     perc = (n_miss /len(base_travail)) * 100</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     print('&gt; %d, Missing: %d (%.1f%%)' % (i, n_miss, perc))</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     i+=1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-entre-les-variables" class="level1">
<h1>Correlation entre les variables</h1>
<section id="avant-de-faire-ça-je-supprime-veux-supprimer-toutes-les-variables-numériques-du-dataframe-qui-contiennent-au-moins-95-de-la-même-valeur" class="level3">
<h3 class="anchored" data-anchor-id="avant-de-faire-ça-je-supprime-veux-supprimer-toutes-les-variables-numériques-du-dataframe-qui-contiennent-au-moins-95-de-la-même-valeur">Avant de faire ça, je supprime veux supprimer toutes les variables numériques du DataFrame qui contiennent au moins 95% de la même valeur</h3>
<div id="5d706629-84b0-4b50-b4b2-563de67a5a0c" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>new_numerical_columns <span class="op">=</span> []</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numerical_columns:  </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    most_frequent_value_count <span class="op">=</span> base_travail[col].value_counts(normalize<span class="op">=</span><span class="va">True</span>).iloc[<span class="dv">0</span>]  <span class="co"># Trouve le pourcentage de la valeur la plus fréquente</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> most_frequent_value_count <span class="op">&lt;</span> <span class="fl">0.95</span>:  <span class="co"># Si moins de 95% des valeurs sont les mêmes</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        new_numerical_columns.append(col)  <span class="co"># Ajoute la colonne à la liste des variables à conserver</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Crée un nouveau DataFrame sans les colonnes qui ne satisfont pas la condition</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>numerical_columns <span class="op">=</span> new_numerical_columns</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(numerical_columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>133</code></pre>
</div>
</div>
<div id="5fd3c067-d4de-4813-9b64-ceabb32b23d2" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculez la matrice de corrélation</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix_quan <span class="op">=</span> base_travail[numerical_columns].corr()</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Créez une carte de chaleur (heatmap)</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix_quan,cmap<span class="op">=</span><span class="st">'coolwarm'</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez un titre</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matrice de Corrélation'</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichez le graphique</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ed36e8f1-f9ff-42ae-98e1-78c7af327656" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définissez un seuil de corrélation (par exemple, 0.8)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>seuil_surveillance <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>seuil_dangereux <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>seuil_inacceptable<span class="op">=</span> <span class="fl">0.9</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Trouvez les paires de variables corrélées</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>variable_pairs_surv <span class="op">=</span> []</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>variable_pairs_dangereux <span class="op">=</span> []</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>variable_pairs_inacceptable <span class="op">=</span> []</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix_quan.columns)):</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(correlation_matrix_quan.columns)):</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(correlation_matrix_quan.iloc[i, j]) <span class="op">&gt;</span> seuil_inacceptable:</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>            variable_pairs_inacceptable.append((base_travail[numerical_columns].columns[i], base_travail[numerical_columns].columns[j]))</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">abs</span>(correlation_matrix_quan.iloc[i, j]) <span class="op">&gt;</span> seuil_dangereux:</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>            variable_pairs_dangereux.append((base_travail[numerical_columns].columns[i], base_travail[numerical_columns].columns[j]))</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">abs</span>(correlation_matrix_quan.iloc[i, j]) <span class="op">&gt;</span> seuil_surveillance:</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>            variable_pairs_surv.append((base_travail[numerical_columns].columns[i], base_travail[numerical_columns].columns[j]))</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichez les paires de variables corrélées</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Paires de variables avec des corrélations inacceptables :"</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_inacceptable:</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Paires de variables avec des corrélations dangereuses :"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_dangereux:</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Paires de variables avec des corrélations à surveiller :"</span>)</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_surv:</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Paires de variables avec des corrélations inacceptables :
('NBOPECAR', 'NBPMTCAR')
('NBOPECARGLISS_M12', 'NBPMTCARGLISS_M12')
('MNTOPECAR', 'MNTPMTCAR')
('NBECRCRD', 'NBECRCRD_mm1')
('NBECRCRD', 'NBECRCRD_mm3')
('NBECRDBT', 'NBECRDBT_mm1')
('NBECRDBT', 'NBECRDBT_mm3')
('MNTECRDBT', 'MNTECRDBT_abs_mm1')
('NBVIRPONEMIGLISS_M12', 'NBCHQEMI')
('NBPLV', 'NBPLV_mm1')
('NBPLV', 'NBPLV_mm3')
('MNTPLV', 'MNTPLV_mm1')
('MNTPLV', 'MNTPLV_mm3')
('MNTTOTMVTAFFGLISS_M12', 'MNTTOTMVTAFFGLISS_M12_mm1')
('NBECRCRD_mm1', 'NBECRCRD_mm3')
('MNTECRCRD_mm1', 'MNTTOTMVTAFF_mm1')
('NBECRDBT_mm1', 'NBECRDBT_mm3')
('NBPLV_mm1', 'NBPLV_mm3')
('MNTPLV_mm1', 'MNTPLV_mm3')
('MNTTOTMVTAFF_mm1', 'MNTTOTMVTAFF_abs_mm1')
('MNTTOTMVTAFFGLISS_M12_mm1', 'MNTTOTMVTAFFGLISS_M12_mm3')
('MNTECRCRD_mm3', 'MNTECRDBT_mm3')
('MNTECRCRD_mm12', 'MNTTOTMVTAFF_mm12')
('MNTTOTMVTAFF_mm12', 'MNTTOTMVTAFF_abs_mm12')
('NBJDEPDP', 'NBJDEPDP_mm3')
('CATTCEUR', 'CATTCEUR_mm12')
('LIGDEB_IND_0015', 'LIGCRE_IND_0009')
('LIGDEB_IND_0015', 'LIGDEB_IND_0015_mm3')
('LIGDEB_IND_0015', 'LIGCRE_IND_0009_mm3')
('LIGCRE_IND_0009', 'LIGDEB_IND_0015_mm3')
('LIGCRE_IND_0009', 'LIGCRE_IND_0009_mm3')
('LIGDEB_IND_0015_mm3', 'LIGCRE_IND_0009_mm3')
('MNTECRDBT_abs_mm1', 'MNTECRDBT_abs_mm3')
('MNTECRDBT_abs_mm1', 'MNTECRDBT_abs_mm12')
('MNTECRDBT_abs_mm3', 'CRTOC_IND_0164_abs_mm3')
('MNTECRDBT_abs_mm3', 'MNTECRDBT_abs_mm12')
('NB_SALARIES_abs_mm12', 'EVOL_NB_SALARIE')
Paires de variables avec des corrélations dangereuses :
('NBOPECAR', 'NBOPECARGLISS_M12')
('NBOPECAR', 'NBPMTCARGLISS_M12')
('NBOPECARGLISS_M12', 'NBPMTCAR')
('NBPMTCAR', 'NBPMTCARGLISS_M12')
('NBECRCRD', 'NBECRCRD_mm12')
('MNTECRCRD', 'MNTECRCRD_abs_mm3')
('NBECRDBT', 'NBECRDBT_mm12')
('MNTECRDBT', 'MNTECRDBT_abs_mm3')
('MNTECRDBT', 'CRTOC_IND_0164_abs_mm3')
('MNTECRDBT', 'MNTECRDBT_abs_mm12')
('NBVIRPONEMI', 'NBCHQEMIGLISS_M12')
('NBPLV', 'NBPLV_mm12')
('MNTPLV', 'MNTPLV_mm12')
('MNTTOTMVTAFFGLISS_M12', 'MNTTOTMVTAFFGLISS_M12_mm3')
('NBECRCRD_mm1', 'NBECRCRD_mm12')
('MNTECRCRD_mm1', 'MNTTOTMVTAFF_abs_mm1')
('NBECRDBT_mm1', 'NBECRDBT_mm12')
('MNTECRDBT_mm1', 'MNTECRCRD_mm3')
('MNTECRDBT_mm1', 'MNTECRDBT_mm3')
('MNTECRDBT_mm1', 'MNTECRDBT_mm12')
('NBPLV_mm1', 'NBPLV_mm12')
('MNTPLV_mm1', 'MNTPLV_mm12')
('MNTTOTMVTAFFGLISS_M12_mm1', 'MNTTOTMVTAFFGLISS_M12_mm12')
('NBECRCRD_mm3', 'NBECRCRD_mm12')
('NBECRDBT_mm3', 'NBECRDBT_mm12')
('NBPLV_mm3', 'NBPLV_mm12')
('MNTPLV_mm3', 'MNTPLV_mm12')
('MNTTOTMVTAFFGLISS_M12_mm3', 'MNTTOTMVTAFFGLISS_M12_mm12')
('MNTECRCRD_mm12', 'MNTTOTMVTAFF_abs_mm12')
('DEPASSEMENT_3dm', 'DEPASSEMENT_6dm')
('DEPASSEMENT_6dm', 'DEPASSEMENT_12dm')
('CRTOC_IND_0301', 'CRTOC_IND_0301_mm3')
('CRTOC_IND_0164', 'MNTECRDBT_abs_mm3')
('CRTOC_IND_0164', 'LIGCRE_IND_0009_abs_mm3')
('CRTOC_IND_0164', 'MNTECRDBT_abs_mm12')
('CRTOC_IND_0301_mm3', 'NBJDEB_IND_0015_mm3')
('LIGDEB_IND_0015', 'LIGDEB_IND_0015_abs_mm3')
('LIGDEB_IND_0015_mm3', 'LIGDEB_IND_0015_abs_mm3')
('MNTECRDBT_abs_mm1', 'CRTOC_IND_0164_abs_mm3')
('CRTOC_IND_0164_abs_mm3', 'MNTECRDBT_abs_mm12')
Paires de variables avec des corrélations à surveiller :
('NBRETCAR', 'NBRETCARGLISS_M12')
('NBRETCAR', 'MNTRETCAR')
('NBECRCRD', 'NBVIRPONRCP')
('MNTECRDBT', 'CRTOC_IND_0164')
('NBVIRPONRCP', 'NBECRCRD_mm1')
('NBVIRPONRCP', 'NBECRCRD_mm3')
('NBVIRPONRCP', 'NBECRCRD_mm12')
('MNTVIRPONRCP', 'MNTTOTMVTAFF')
('MNTTOTMVTAFFGLISS_M12', 'MNTTOTMVTAFFGLISS_M12_mm12')
('MNTECRCRD_mm3', 'MNTTOTMVTAFF_mm3')
('MNTECRCRD_mm3', 'MNTECRDBT_mm12')
('MNTECRDBT_mm3', 'MNTECRDBT_mm12')
('DEPASSEMENT_3dm', 'DEPASSEMENT_12dm')
('NBJ_ARR_6dm', 'NBJ_ARR_12dm')
('CRTOC_IND_0301', 'NBJDEB_IND_0015')
('CRTOC_IND_0164', 'CRTOC_IND_0164_mm3')
('CRTOC_IND_0164', 'MNTECRDBT_abs_mm1')
('CRTOC_IND_0164', 'CRTOC_IND_0164_abs_mm3')
('NB_SALARIES', 'NB_SALARIES_mm12')
('NBJDEB_IND_0015', 'NBJDEB_IND_0015_mm3')
('LIGCRE_IND_0009', 'LIGDEB_IND_0015_abs_mm3')
('LIGCRE_IND_0009_mm3', 'LIGDEB_IND_0015_abs_mm3')
('MNTECRCRD_abs_mm1', 'MNTTOTMVTAFF_abs_mm1')
('NBJDEB_IND_0015_abs_mm3', 'NBJDEB_NA_abs_mm3')
('LIGCRE_IND_0009_abs_mm3', 'MNTECRDBT_abs_mm12')
('MNTECRCRD_abs_mm12', 'MNTTOTMVTAFF_abs_mm12')</code></pre>
</div>
</div>
<div id="1fa801b3-0649-40c5-b064-a847068cf11e" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pairs_vars_suppr <span class="op">=</span> variable_pairs_inacceptable <span class="op">+</span> variable_pairs_dangereux</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>pairs_vars_suppr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>[('NBOPECAR', 'NBPMTCAR'),
 ('NBOPECARGLISS_M12', 'NBPMTCARGLISS_M12'),
 ('MNTOPECAR', 'MNTPMTCAR'),
 ('NBECRCRD', 'NBECRCRD_mm1'),
 ('NBECRCRD', 'NBECRCRD_mm3'),
 ('NBECRDBT', 'NBECRDBT_mm1'),
 ('NBECRDBT', 'NBECRDBT_mm3'),
 ('MNTECRDBT', 'MNTECRDBT_abs_mm1'),
 ('NBVIRPONEMIGLISS_M12', 'NBCHQEMI'),
 ('NBPLV', 'NBPLV_mm1'),
 ('NBPLV', 'NBPLV_mm3'),
 ('MNTPLV', 'MNTPLV_mm1'),
 ('MNTPLV', 'MNTPLV_mm3'),
 ('MNTTOTMVTAFFGLISS_M12', 'MNTTOTMVTAFFGLISS_M12_mm1'),
 ('NBECRCRD_mm1', 'NBECRCRD_mm3'),
 ('MNTECRCRD_mm1', 'MNTTOTMVTAFF_mm1'),
 ('NBECRDBT_mm1', 'NBECRDBT_mm3'),
 ('NBPLV_mm1', 'NBPLV_mm3'),
 ('MNTPLV_mm1', 'MNTPLV_mm3'),
 ('MNTTOTMVTAFF_mm1', 'MNTTOTMVTAFF_abs_mm1'),
 ('MNTTOTMVTAFFGLISS_M12_mm1', 'MNTTOTMVTAFFGLISS_M12_mm3'),
 ('MNTECRCRD_mm3', 'MNTECRDBT_mm3'),
 ('MNTECRCRD_mm12', 'MNTTOTMVTAFF_mm12'),
 ('MNTTOTMVTAFF_mm12', 'MNTTOTMVTAFF_abs_mm12'),
 ('NBJDEPDP', 'NBJDEPDP_mm3'),
 ('CATTCEUR', 'CATTCEUR_mm12'),
 ('LIGDEB_IND_0015', 'LIGCRE_IND_0009'),
 ('LIGDEB_IND_0015', 'LIGDEB_IND_0015_mm3'),
 ('LIGDEB_IND_0015', 'LIGCRE_IND_0009_mm3'),
 ('LIGCRE_IND_0009', 'LIGDEB_IND_0015_mm3'),
 ('LIGCRE_IND_0009', 'LIGCRE_IND_0009_mm3'),
 ('LIGDEB_IND_0015_mm3', 'LIGCRE_IND_0009_mm3'),
 ('MNTECRDBT_abs_mm1', 'MNTECRDBT_abs_mm3'),
 ('MNTECRDBT_abs_mm1', 'MNTECRDBT_abs_mm12'),
 ('MNTECRDBT_abs_mm3', 'CRTOC_IND_0164_abs_mm3'),
 ('MNTECRDBT_abs_mm3', 'MNTECRDBT_abs_mm12'),
 ('NB_SALARIES_abs_mm12', 'EVOL_NB_SALARIE'),
 ('NBOPECAR', 'NBOPECARGLISS_M12'),
 ('NBOPECAR', 'NBPMTCARGLISS_M12'),
 ('NBOPECARGLISS_M12', 'NBPMTCAR'),
 ('NBPMTCAR', 'NBPMTCARGLISS_M12'),
 ('NBECRCRD', 'NBECRCRD_mm12'),
 ('MNTECRCRD', 'MNTECRCRD_abs_mm3'),
 ('NBECRDBT', 'NBECRDBT_mm12'),
 ('MNTECRDBT', 'MNTECRDBT_abs_mm3'),
 ('MNTECRDBT', 'CRTOC_IND_0164_abs_mm3'),
 ('MNTECRDBT', 'MNTECRDBT_abs_mm12'),
 ('NBVIRPONEMI', 'NBCHQEMIGLISS_M12'),
 ('NBPLV', 'NBPLV_mm12'),
 ('MNTPLV', 'MNTPLV_mm12'),
 ('MNTTOTMVTAFFGLISS_M12', 'MNTTOTMVTAFFGLISS_M12_mm3'),
 ('NBECRCRD_mm1', 'NBECRCRD_mm12'),
 ('MNTECRCRD_mm1', 'MNTTOTMVTAFF_abs_mm1'),
 ('NBECRDBT_mm1', 'NBECRDBT_mm12'),
 ('MNTECRDBT_mm1', 'MNTECRCRD_mm3'),
 ('MNTECRDBT_mm1', 'MNTECRDBT_mm3'),
 ('MNTECRDBT_mm1', 'MNTECRDBT_mm12'),
 ('NBPLV_mm1', 'NBPLV_mm12'),
 ('MNTPLV_mm1', 'MNTPLV_mm12'),
 ('MNTTOTMVTAFFGLISS_M12_mm1', 'MNTTOTMVTAFFGLISS_M12_mm12'),
 ('NBECRCRD_mm3', 'NBECRCRD_mm12'),
 ('NBECRDBT_mm3', 'NBECRDBT_mm12'),
 ('NBPLV_mm3', 'NBPLV_mm12'),
 ('MNTPLV_mm3', 'MNTPLV_mm12'),
 ('MNTTOTMVTAFFGLISS_M12_mm3', 'MNTTOTMVTAFFGLISS_M12_mm12'),
 ('MNTECRCRD_mm12', 'MNTTOTMVTAFF_abs_mm12'),
 ('DEPASSEMENT_3dm', 'DEPASSEMENT_6dm'),
 ('DEPASSEMENT_6dm', 'DEPASSEMENT_12dm'),
 ('CRTOC_IND_0301', 'CRTOC_IND_0301_mm3'),
 ('CRTOC_IND_0164', 'MNTECRDBT_abs_mm3'),
 ('CRTOC_IND_0164', 'LIGCRE_IND_0009_abs_mm3'),
 ('CRTOC_IND_0164', 'MNTECRDBT_abs_mm12'),
 ('CRTOC_IND_0301_mm3', 'NBJDEB_IND_0015_mm3'),
 ('LIGDEB_IND_0015', 'LIGDEB_IND_0015_abs_mm3'),
 ('LIGDEB_IND_0015_mm3', 'LIGDEB_IND_0015_abs_mm3'),
 ('MNTECRDBT_abs_mm1', 'CRTOC_IND_0164_abs_mm3'),
 ('CRTOC_IND_0164_abs_mm3', 'MNTECRDBT_abs_mm12')]</code></pre>
</div>
</div>
<div id="d6aae49b-b96a-4b0a-9ae8-7314d17e3641" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>vars_suppr_quan <span class="op">=</span>[<span class="st">'NBJ_ARR'</span>]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> pairs_vars_suppr:</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">float</span>(Kw_test[<span class="st">'H-statistic'</span>][Kw_test[<span class="st">'Variable'</span>]<span class="op">==</span>pair[<span class="dv">0</span>]]) <span class="op">&lt;</span> <span class="bu">float</span>(Kw_test[<span class="st">'H-statistic'</span>][Kw_test[<span class="st">'Variable'</span>]<span class="op">==</span>pair[<span class="dv">1</span>]]):</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        vars_suppr_quan.append(pair[<span class="dv">0</span>])</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>        vars_suppr_quan.append(pair[<span class="dv">1</span>])</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>vars_suppr_quan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>['NBJ_ARR',
 'NBOPECAR',
 'NBOPECARGLISS_M12',
 'MNTOPECAR',
 'NBECRCRD_mm1',
 'NBECRCRD_mm3',
 'NBECRDBT_mm1',
 'NBECRDBT_mm3',
 'MNTECRDBT_abs_mm1',
 'NBCHQEMI',
 'NBPLV_mm1',
 'NBPLV_mm3',
 'MNTPLV_mm1',
 'MNTPLV_mm3',
 'MNTTOTMVTAFFGLISS_M12_mm1',
 'NBECRCRD_mm3',
 'MNTTOTMVTAFF_mm1',
 'NBECRDBT_mm3',
 'NBPLV_mm3',
 'MNTPLV_mm3',
 'MNTTOTMVTAFF_abs_mm1',
 'MNTTOTMVTAFFGLISS_M12_mm3',
 'MNTECRCRD_mm3',
 'MNTTOTMVTAFF_mm12',
 'MNTTOTMVTAFF_abs_mm12',
 'NBJDEPDP_mm3',
 'CATTCEUR',
 'LIGDEB_IND_0015',
 'LIGDEB_IND_0015_mm3',
 'LIGDEB_IND_0015',
 'LIGDEB_IND_0015_mm3',
 'LIGCRE_IND_0009_mm3',
 'LIGDEB_IND_0015_mm3',
 'MNTECRDBT_abs_mm1',
 'MNTECRDBT_abs_mm1',
 'CRTOC_IND_0164_abs_mm3',
 'MNTECRDBT_abs_mm3',
 'EVOL_NB_SALARIE',
 'NBOPECARGLISS_M12',
 'NBPMTCARGLISS_M12',
 'NBOPECARGLISS_M12',
 'NBPMTCARGLISS_M12',
 'NBECRCRD_mm12',
 'MNTECRCRD_abs_mm3',
 'NBECRDBT_mm12',
 'MNTECRDBT_abs_mm3',
 'CRTOC_IND_0164_abs_mm3',
 'MNTECRDBT_abs_mm12',
 'NBCHQEMIGLISS_M12',
 'NBPLV_mm12',
 'MNTPLV_mm12',
 'MNTTOTMVTAFFGLISS_M12_mm3',
 'NBECRCRD_mm12',
 'MNTTOTMVTAFF_abs_mm1',
 'NBECRDBT_mm12',
 'MNTECRCRD_mm3',
 'MNTECRDBT_mm3',
 'MNTECRDBT_mm12',
 'NBPLV_mm12',
 'MNTPLV_mm12',
 'MNTTOTMVTAFFGLISS_M12_mm12',
 'NBECRCRD_mm12',
 'NBECRDBT_mm12',
 'NBPLV_mm12',
 'MNTPLV_mm12',
 'MNTTOTMVTAFFGLISS_M12_mm12',
 'MNTTOTMVTAFF_abs_mm12',
 'DEPASSEMENT_3dm',
 'DEPASSEMENT_12dm',
 'CRTOC_IND_0301',
 'MNTECRDBT_abs_mm3',
 'LIGCRE_IND_0009_abs_mm3',
 'MNTECRDBT_abs_mm12',
 'CRTOC_IND_0301_mm3',
 'LIGDEB_IND_0015_abs_mm3',
 'LIGDEB_IND_0015_abs_mm3',
 'MNTECRDBT_abs_mm1',
 'CRTOC_IND_0164_abs_mm3']</code></pre>
</div>
</div>
<div id="bd5b11d9-78cf-470c-bc86-2b9c49ade5cc" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(pairs_vars_suppr))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(vars_suppr_quan))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(unique(vars_suppr_quan)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>77
78
46</code></pre>
</div>
</div>
<div id="db46d9d3-f959-4b0e-a98f-612bd8249168" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>unique(vars_suppr_quan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>array(['CATTCEUR', 'CRTOC_IND_0164_abs_mm3', 'CRTOC_IND_0301',
       'CRTOC_IND_0301_mm3', 'DEPASSEMENT_12dm', 'DEPASSEMENT_3dm',
       'EVOL_NB_SALARIE', 'LIGCRE_IND_0009_abs_mm3',
       'LIGCRE_IND_0009_mm3', 'LIGDEB_IND_0015',
       'LIGDEB_IND_0015_abs_mm3', 'LIGDEB_IND_0015_mm3',
       'MNTECRCRD_abs_mm3', 'MNTECRCRD_mm3', 'MNTECRDBT_abs_mm1',
       'MNTECRDBT_abs_mm12', 'MNTECRDBT_abs_mm3', 'MNTECRDBT_mm12',
       'MNTECRDBT_mm3', 'MNTOPECAR', 'MNTPLV_mm1', 'MNTPLV_mm12',
       'MNTPLV_mm3', 'MNTTOTMVTAFFGLISS_M12_mm1',
       'MNTTOTMVTAFFGLISS_M12_mm12', 'MNTTOTMVTAFFGLISS_M12_mm3',
       'MNTTOTMVTAFF_abs_mm1', 'MNTTOTMVTAFF_abs_mm12',
       'MNTTOTMVTAFF_mm1', 'MNTTOTMVTAFF_mm12', 'NBCHQEMI',
       'NBCHQEMIGLISS_M12', 'NBECRCRD_mm1', 'NBECRCRD_mm12',
       'NBECRCRD_mm3', 'NBECRDBT_mm1', 'NBECRDBT_mm12', 'NBECRDBT_mm3',
       'NBJDEPDP_mm3', 'NBJ_ARR', 'NBOPECAR', 'NBOPECARGLISS_M12',
       'NBPLV_mm1', 'NBPLV_mm12', 'NBPLV_mm3', 'NBPMTCARGLISS_M12'],
      dtype='&lt;U26')</code></pre>
</div>
</div>
<div id="afffe9ce-fb9f-4425-8cbe-a22473bdb3da" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cat_df <span class="op">=</span> base_travail[categorical_columns]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour calculer le V de Cramer</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cramers_v(confusion_matrix):</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    chi2 <span class="op">=</span> chi2_contingency(confusion_matrix)[<span class="dv">0</span>]</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> confusion_matrix.<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    phi2 <span class="op">=</span> chi2 <span class="op">/</span> n</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    r, k <span class="op">=</span> confusion_matrix.shape</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    phi2corr <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, phi2 <span class="op">-</span> ((k <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> (r <span class="op">-</span> <span class="dv">1</span>)) <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    rcorr <span class="op">=</span> r <span class="op">-</span> ((r <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    kcorr <span class="op">=</span> k <span class="op">-</span> ((k <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(phi2corr <span class="op">/</span> <span class="bu">min</span>((kcorr <span class="op">-</span> <span class="dv">1</span>), (rcorr <span class="op">-</span> <span class="dv">1</span>)))</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculez la matrice de corrélation basée sur le V de Cramer</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>corr_matrix_cat <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>cat_df.columns, columns<span class="op">=</span>cat_df.columns, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> cat_df.columns:</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> cat_df.columns:</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> j:</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>            confusion_matrix_cat <span class="op">=</span> pd.crosstab(cat_df[i], cat_df[j])</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>            corr_matrix_cat.loc[i, j] <span class="op">=</span> cramers_v(confusion_matrix_cat)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Créez une carte de chaleur (heatmap) basée sur le V de Cramer</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix_cat, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez un titre</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matrice de Corrélation (V de Cramer)'</span>)</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichez le graphique</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="59bc7b67-c146-4517-85be-61130a91a9b8" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>seuil_corr <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>variable_pairs_cat_inacceptable <span class="op">=</span> []</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(corr_matrix_cat.columns)):</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(corr_matrix_cat.columns)):</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(corr_matrix_cat.iloc[i, j]) <span class="op">&gt;</span> seuil_corr:</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>            variable_pairs_cat_inacceptable.append((base_travail[categorical_columns].columns[i], base_travail[categorical_columns].columns[j]))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichez les paires de variables corrélées</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Paires de variables avec des corrélations inacceptables :"</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_cat_inacceptable:</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Paires de variables avec des corrélations inacceptables :
('CODNAF2', 'SEC_DER')
('CODNAF2', 'TOP_SCI')
('SEC_DER', 'TOP_SCI')
('COULEUR_PART_M', 'COULEUR_PART_MM3_M')
('COULEUR_PART_M', 'CODTYPPRS')
('COULEUR_PART_MM3_M', 'CODTYPPRS')
('CODETAJUR', 'CODTYPPRS')
('CODETAJUR', 'TOP_SCI')
('CODTYPPRS', 'CODACVPRO')
('CHR_USAGE_NDB_V1_4', 'COULEUR_IRPRO')
('CHR_USAGE_NDB_V1_4', 'IRPRO_rouge_3dm')
('CHR_USAGE_NDB_V1_4', 'classe_finale_NDB')
('CHR_USAGE_mm1', 'COULEUR_IRPRO')
('CHR_USAGE_mm1', 'COULEUR_IRPRO_mm1')
('CHR_USAGE_mm1', 'IRPRO_rouge_3dm')
('CHR_USAGE_mm3', 'IRPRO_rouge_3dm')
('CHR_USAGE_mm3', 'NDB_3dm')
('COULEUR_IRPRO', 'COULEUR_IRPRO_mm1')
('COULEUR_IRPRO', 'IRPRO_rouge_3dm')
('COULEUR_IRPRO', 'classe_finale_NDB')
('COULEUR_IRPRO_mm1', 'IRPRO_rouge_3dm')
('INDDBLRLNPAR', 'INDRSKITDBDF')
('IRPRO_rouge_3dm', 'classe_finale_NDB')
('NDB_12dm', 'NDB_6dm')
('NDB_12dm', 'NDB_3dm')
('NDB_6dm', 'NDB_3dm')</code></pre>
</div>
</div>
<div id="dbb6a8f0-0322-469b-af56-7fcd94634cfa" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>vars_suppr_cat <span class="op">=</span>[]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>Chi2test <span class="op">=</span> chi_squared_test(base_travail,target[target_column],categorical_columns).sort_values(by <span class="op">=</span><span class="st">'Chi2'</span>,ascending <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_cat_inacceptable:</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">float</span>(Chi2test[<span class="st">'V de Cramer'</span>][Chi2test[<span class="st">'Variable'</span>]<span class="op">==</span>pair[<span class="dv">0</span>]]) <span class="op">&lt;</span> <span class="bu">float</span>(Chi2test[<span class="st">'V de Cramer'</span>][Chi2test[<span class="st">'Variable'</span>]<span class="op">==</span>pair[<span class="dv">1</span>]]):</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>        vars_suppr_cat.append(pair[<span class="dv">0</span>])</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>        vars_suppr_cat.append(pair[<span class="dv">1</span>])</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>vars_suppr_cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>['SEC_DER',
 'TOP_SCI',
 'TOP_SCI',
 'COULEUR_PART_M',
 'CODTYPPRS',
 'CODTYPPRS',
 'CODTYPPRS',
 'TOP_SCI',
 'CODTYPPRS',
 'COULEUR_IRPRO',
 'IRPRO_rouge_3dm',
 'CHR_USAGE_NDB_V1_4',
 'COULEUR_IRPRO',
 'COULEUR_IRPRO_mm1',
 'IRPRO_rouge_3dm',
 'IRPRO_rouge_3dm',
 'NDB_3dm',
 'COULEUR_IRPRO_mm1',
 'IRPRO_rouge_3dm',
 'COULEUR_IRPRO',
 'IRPRO_rouge_3dm',
 'INDDBLRLNPAR',
 'IRPRO_rouge_3dm',
 'NDB_6dm',
 'NDB_3dm',
 'NDB_3dm']</code></pre>
</div>
</div>
<div id="e6697354-51cd-46a3-a079-27009d0d6cd4" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(base_travail[categorical_columns].columns))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(variable_pairs_cat_inacceptable))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(vars_suppr_cat))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(unique(vars_suppr_cat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>29
26
26
11</code></pre>
</div>
</div>
<div id="cd8d3b25-efbc-40e6-ba12-b9fde0c1efe4" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>vars_suppr <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(vars_suppr_cat))<span class="op">+</span><span class="bu">list</span>(<span class="bu">set</span>(vars_suppr_quan))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>base_travail_decorr <span class="op">=</span> base_travail.drop(vars_suppr, axis <span class="op">=</span> <span class="dv">1</span>).copy()</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(base_travail_decorr.columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>126</code></pre>
</div>
</div>
<div id="eaa21ab3" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test.drop(vars_suppr, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(X_test.columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>125</code></pre>
</div>
</div>
</section>
</section>
<section id="selection-des-variables" class="level1">
<h1>Selection des variables</h1>
<div id="6782fc6d-b474-4f80-a264-27a2881162ec" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>categorical_columns_decorr <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> categorical_columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> vars_suppr_cat]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>base_test2_chi2<span class="op">=</span> chi_squared_test(base_travail_decorr,target[target_column],categorical_columns_decorr).sort_values(by <span class="op">=</span><span class="st">'Tschuprow T'</span>,ascending <span class="op">=</span> <span class="va">True</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>plt.barh(base_test2_chi2[<span class="st">'Variable'</span>], base_test2_chi2[<span class="st">'Tschuprow T'</span>])</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez des étiquettes et un titre</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'T de Tschuprow'</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variable'</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variables catégorielles dépendantes de la variable cible'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>Text(0.5, 1.0, 'Variables catégorielles dépendantes de la variable cible')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-54-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cbab4260-c76d-4575-b73a-68fec641863a" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>base_test3_chi2<span class="op">=</span> chi_squared_test(base_travail_decorr,target[target_column],categorical_columns_decorr).sort_values(by <span class="op">=</span><span class="st">'V de Cramer'</span>,ascending <span class="op">=</span> <span class="va">True</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>plt.barh(base_test3_chi2[<span class="st">'Variable'</span>], base_test3_chi2[<span class="st">'V de Cramer'</span>])</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez des étiquettes et un titre</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'V de Cramer'</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variable'</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.06</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variables catégorielles dépendantes de la variable cible'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Text(0.5, 1.0, 'Variables catégorielles dépendantes de la variable cible')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-55-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c117a215-1637-48bf-9883-70ec7a1e15c9" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>vars_cat_sel <span class="op">=</span> base_test3_chi2[<span class="st">'Variable'</span>][base_test3_chi2[<span class="st">'V de Cramer'</span>]<span class="op">&gt;</span><span class="fl">0.06</span>]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>vars_cat_sel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>3                  Type_fdc_dm
14     Degra_couleur_IRPRO_mm1
1           COULEUR_PART_MM3_M
11    Degra_IRPRO_continue_3dm
15                INDRSKITDBDF
2                    CODETAJUR
16                    NDB_12dm
12             Degra_IRPRO_mm1
0                      CODNAF2
4              Degra_IRPRO_mm6
13             Degra_IRPRO_mm3
7                CHR_USAGE_mm6
6                CHR_USAGE_mm3
5                CHR_USAGE_mm1
17           classe_finale_NDB
Name: Variable, dtype: object</code></pre>
</div>
</div>
<div id="afb13ec6-ff62-4755-99a8-9d693af20c0a" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>numerical_columns_decorr <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> numerical_columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> vars_suppr_quan]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>Kw_test_decorr <span class="op">=</span> kruskal_wallis_test(base_travail_decorr, target_column, target, numerical_columns_decorr).sort_values(by <span class="op">=</span> <span class="st">'H-statistic'</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>plt.barh(Kw_test_decorr[<span class="st">'Variable'</span>], Kw_test_decorr[<span class="st">'H-statistic'</span>])</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez des étiquettes et un titre</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'H-statistic'</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variable'</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">15000</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variables quantitatives dépendantes de la variable cible'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>Text(0.5, 1.0, 'Variables quantitatives dépendantes de la variable cible')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-57-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3f91ed3f-86c0-40bc-9c4f-45c2416673b7" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>vars_quan_sel <span class="op">=</span> Kw_test_decorr[<span class="st">'Variable'</span>][Kw_test_decorr[<span class="st">'H-statistic'</span>]<span class="op">&gt;</span><span class="dv">15000</span>]</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>vars_quan_sel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>45          LIGCRE_IND_0009
30              NBJ_ARR_6dm
38            NBJDEB_NA_mm3
36           CRTOC_IND_0164
43    NB_MOIS_AVEC_ARR_12dm
31             NBJ_ARR_12dm
44          NBJDEB_IND_0015
29          DEPASSEMENT_6dm
35                NBJDEB_NA
33                 NBJDEPDP
28              DEPASSEMENT
Name: Variable, dtype: object</code></pre>
</div>
</div>
<div id="75df7e2c-1b6f-4da7-a42a-c95149a11e33" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>vars_sel <span class="op">=</span> <span class="bu">list</span>(vars_cat_sel)<span class="op">+</span><span class="bu">list</span>(vars_quan_sel)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>vars_sel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>['Type_fdc_dm',
 'Degra_couleur_IRPRO_mm1',
 'COULEUR_PART_MM3_M',
 'Degra_IRPRO_continue_3dm',
 'INDRSKITDBDF',
 'CODETAJUR',
 'NDB_12dm',
 'Degra_IRPRO_mm1',
 'CODNAF2',
 'Degra_IRPRO_mm6',
 'Degra_IRPRO_mm3',
 'CHR_USAGE_mm6',
 'CHR_USAGE_mm3',
 'CHR_USAGE_mm1',
 'classe_finale_NDB',
 'LIGCRE_IND_0009',
 'NBJ_ARR_6dm',
 'NBJDEB_NA_mm3',
 'CRTOC_IND_0164',
 'NB_MOIS_AVEC_ARR_12dm',
 'NBJ_ARR_12dm',
 'NBJDEB_IND_0015',
 'DEPASSEMENT_6dm',
 'NBJDEB_NA',
 'NBJDEPDP',
 'DEPASSEMENT']</code></pre>
</div>
</div>
<div id="2d68dfc6-2192-4d0e-870e-69d05f0bd244" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(vars_sel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>26</code></pre>
</div>
</div>
<section id="discrétisation-des-variables" class="level2">
<h2 class="anchored" data-anchor-id="discrétisation-des-variables">Discrétisation des variables</h2>
<div id="395acba8-9d54-4d32-ac56-46deef8c4913" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">variable_dis = base_travail['CRTOD_CMT_IND_0036']</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">q25, q75 = percentile(variable_dis, 25), percentile(variable_dis, 75)</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">            # define outliers</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">iqr = q75 - q25</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">            # calculate the outlier cutoff</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">cut_off = iqr * 1.5</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co">lower, upper = q25 - cut_off, q75 + cut_off</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>"\nvariable_dis = base_travail['CRTOD_CMT_IND_0036']\nq25, q75 = percentile(variable_dis, 25), percentile(variable_dis, 75)\n            # define outliers\niqr = q75 - q25\n            # calculate the outlier cutoff\ncut_off = iqr * 1.5\nlower, upper = q25 - cut_off, q75 + cut_off\n"</code></pre>
</div>
</div>
<div id="d692e029-3d3d-4983-8e9f-4aa9349ba016" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">filtered_values = variable_dis[(variable_dis &gt;= lower) &amp; (variable_dis &lt;= upper)]</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">print(filtered_values)</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>'\nfiltered_values = variable_dis[(variable_dis &gt;= lower) &amp; (variable_dis &lt;= upper)]\nprint(filtered_values)\n'</code></pre>
</div>
</div>
<div id="4637e724-481f-4173-aa1b-da9e25bfa8ad" class="cell" data-scrolled="true" data-execution_count="61">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filtered_values.hist(bins=10)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c0900a08-9367-45b0-a56b-af24250bf53e" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">import pandas as pd</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co">variables_to_keep = []</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">for col in numerical_columns:  # Sélectionne uniquement les colonnes numériques</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co">    if col != 'date':</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co">        quantile_95 = base_travail[col].quantile(0.95)  # Calcule le 95e percentile</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co">        if not (base_travail[col].dropna() &lt; quantile_95).any():</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co">            variables_to_keep.append(col)</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 'variables_to_keep' contient maintenant les noms des colonnes qui satisfont la condition</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co">print(variables_to_keep)</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>"\nimport pandas as pd\n\nvariables_to_keep = []\n\nfor col in numerical_columns:  # Sélectionne uniquement les colonnes numériques\n    if col != 'date':\n        quantile_95 = base_travail[col].quantile(0.95)  # Calcule le 95e percentile\n        if not (base_travail[col].dropna() &lt; quantile_95).any():\n            variables_to_keep.append(col)\n\n# 'variables_to_keep' contient maintenant les noms des colonnes qui satisfont la condition\nprint(variables_to_keep)\n"</code></pre>
</div>
</div>
<div id="cb4a2b38-3ee9-405a-9179-ee4c78067be4" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">deciles = base_travail['MNTECSCPTEPA'].quantile([.1, .2, .3, .4, .5, .6, .7, .8, .9])</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">base_travail['MNTECSCPTEPA'].quantile([0.95])</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>"\ndeciles = base_travail['MNTECSCPTEPA'].quantile([.1, .2, .3, .4, .5, .6, .7, .8, .9])\n\nbase_travail['MNTECSCPTEPA'].quantile([0.95])\n"</code></pre>
</div>
</div>
<div id="ddcc5244-1f3a-4bf6-accd-933cdef4c56d" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>discret <span class="op">=</span> base_travail[vars_sel<span class="op">+</span>[<span class="st">'date'</span>]].copy()</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">'target_column'</span>] <span class="op">=</span> y_train.copy().astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3b17a50c" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>discret_test <span class="op">=</span> X_test[vars_sel<span class="op">+</span>[<span class="st">'date'</span>]].copy()</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'target_column'</span>] <span class="op">=</span> y_test.copy().astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6dc6089e-4fb4-4ffe-88c6-b5235166b1e1" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co">discret['decile'] = pd.qcut(discret['CRTOC_IND_0164'], 10, labels=False, duplicates='drop')</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co">discret['NB_MOIS_AVEC_ARR_12dm'].nunique()</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>"\ndiscret['decile'] = pd.qcut(discret['CRTOC_IND_0164'], 10, labels=False, duplicates='drop')\n\ndiscret['NB_MOIS_AVEC_ARR_12dm'].nunique()\n"</code></pre>
</div>
</div>
<div id="6bdccff3-c9ce-40b9-b22d-4e543c78fa02" class="cell" data-scrolled="true" data-execution_count="67">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> vars_quan_sel:</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    discret[<span class="st">'decile'</span>] <span class="op">=</span> pd.qcut(discret[col], <span class="dv">10</span>, labels<span class="op">=</span><span class="va">None</span>, duplicates<span class="op">=</span><span class="st">'drop'</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    df_grouped <span class="op">=</span> discret.groupby(<span class="st">'decile'</span>).agg(</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>        taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    df_grouped[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped[<span class="st">'population'</span>] <span class="op">/</span> df_grouped[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Afficher le DataFrame groupé avec les proportions</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(col)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_grouped)</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vars_quan_sel)</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________________________
LIGCRE_IND_0009
________________________________________________________________________________________________
                               taux_risque  population  proportion
decile                                                            
(-0.001, 745256.4]               15.422778       41724   10.000048
(745256.4, 3447892.2]            10.399291       41724   10.000048
(3447892.2, 8026657.2]            6.859362       41724   10.000048
(8026657.2, 15749405.8]           4.877406       41723    9.999808
(15749405.8, 28849902.0]          3.568689       41724   10.000048
(28849902.0, 51538123.6]          2.533314       41724   10.000048
(51538123.6, 92272689.9]          1.601035       41723    9.999808
(92272689.9, 168230802.4]         1.083309       41724   10.000048
(168230802.4, 361009431.2]        0.627936       41724   10.000048
(361009431.2, 618512624372.0]     0.448183       41724   10.000048
________________________________________________________________________________________________
NBJ_ARR_6dm
________________________________________________________________________________________________
                  taux_risque  population  proportion
decile                                               
(-0.001, 1185.0]     4.742138      417238       100.0
________________________________________________________________________________________________
NBJDEB_NA_mm3
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-2.001, 0.0]     2.665967      327836   78.572901
(0.0, 1.0]        5.175639        9622    2.306118
(1.0, 12.0]       8.016579       38121    9.136512
(12.0, 92.0]     17.984109       41659    9.984469
________________________________________________________________________________________________
CRTOC_IND_0164
________________________________________________________________________________________________
                            taux_risque  population  proportion
decile                                                         
(-1316170300.001, -8800.0]    11.776390       41787   10.015147
(-8800.0, 0.0]                10.481638       65381   15.669953
(0.0, 16600.0]                11.279863       18041    4.323911
(16600.0, 149800.0]            6.394205       41694    9.992858
(149800.0, 427800.0]           3.216451       41723    9.999808
(427800.0, 971420.0]           2.066304       41717    9.998370
(971420.0, 2049000.0]          1.169591       41724   10.000048
(2049000.0, 4249660.0]         0.704647       41723    9.999808
(4249660.0, 9975260.0]         0.431406       41724   10.000048
(9975260.0, 27961103400.0]     0.347522       41724   10.000048
________________________________________________________________________________________________
NB_MOIS_AVEC_ARR_12dm
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-0.001, 1.0]     3.766897      396666   95.069481
(1.0, 12.0]      23.546568       20572    4.930519
________________________________________________________________________________________________
NBJ_ARR_12dm
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-0.001, 2.0]     3.281001      379244   90.893926
(2.0, 1185.0]    19.326736       37994    9.106074
________________________________________________________________________________________________
NBJDEB_IND_0015
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-0.001, 4.0]     1.834959      293576   70.361760
(4.0, 20.0]       7.091477       41289    9.895791
(20.0, 55.0]     12.604796       41032    9.834195
(55.0, 92.0]     15.236690       41341    9.908254
________________________________________________________________________________________________
DEPASSEMENT_6dm
________________________________________________________________________________________________
                     taux_risque  population  proportion
decile                                                  
(-0.001, 106.68]        3.477890      375515   90.000192
(106.68, 922783.24]    16.120605       41723    9.999808
________________________________________________________________________________________________
NBJDEB_NA
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-0.001, 3.0]     2.007978      334167   80.090260
(3.0, 19.0]       9.304448       42743   10.244273
(19.0, 92.0]     22.562488       40328    9.665467
________________________________________________________________________________________________
NBJDEPDP
________________________________________________________________________________________________
                  taux_risque  population  proportion
decile                                               
(-0.001, 3161.0]     4.742138      417238       100.0
________________________________________________________________________________________________
DEPASSEMENT
________________________________________________________________________________________________
                     taux_risque  population  proportion
decile                                                  
(-0.001, 771859.14]     4.742138      417238       100.0
45          LIGCRE_IND_0009
30              NBJ_ARR_6dm
38            NBJDEB_NA_mm3
36           CRTOC_IND_0164
43    NB_MOIS_AVEC_ARR_12dm
31             NBJ_ARR_12dm
44          NBJDEB_IND_0015
29          DEPASSEMENT_6dm
35                NBJDEB_NA
33                 NBJDEPDP
28              DEPASSEMENT
Name: Variable, dtype: object</code></pre>
</div>
</div>
<div id="af41aac6-af5f-48fa-b3bb-2a8938c6a202" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>discret_dep <span class="op">=</span> discret.copy()</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>discret_dep[<span class="st">'decile'</span>] <span class="op">=</span> pd.qcut(discret_dep[<span class="st">'DEPASSEMENT'</span>], <span class="dv">100</span>, labels<span class="op">=</span><span class="va">None</span>, duplicates<span class="op">=</span><span class="st">'drop'</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>df_grouped_dep <span class="op">=</span> discret_dep.groupby(<span class="st">'decile'</span>).agg(</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>df_grouped_dep[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped_dep[<span class="st">'population'</span>] <span class="op">/</span> df_grouped_dep[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le DataFrame groupé avec les proportions</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'DEPASSEMENT'</span>)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_dep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________________________
DEPASSEMENT
________________________________________________________________________________________________
                    taux_risque  population  proportion
decile                                                 
(-0.001, 2.32]         2.882033      383861   92.000489
(2.32, 8.2]            9.909047        4178    1.001347
(8.2, 17.088]         10.902978        4164    0.997992
(17.088, 30.86]       16.243412        4174    1.000388
(30.86, 50.305]       28.026852        4171    0.999669
(50.305, 64.19]       34.235745        4174    1.000388
(64.19, 83.193]       46.008152        4171    0.999669
(83.193, 190.7]       46.393482        4173    1.000149
(190.7, 771859.14]    17.353787        4172    0.999909</code></pre>
</div>
</div>
<div id="929d5aa0-aa1f-4065-ae6c-23d1f44df9ff" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>discret_nbjepdp <span class="op">=</span> discret.copy()</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>discret_nbjepdp[<span class="st">'decile'</span>] <span class="op">=</span> pd.qcut(discret_nbjepdp[<span class="st">'NBJDEPDP'</span>], <span class="dv">100</span>, labels<span class="op">=</span><span class="va">None</span>, duplicates<span class="op">=</span><span class="st">'drop'</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>df_grouped_nbjepdp <span class="op">=</span> discret_nbjepdp.groupby(<span class="st">'decile'</span>).agg(</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>df_grouped_nbjepdp[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped_nbjepdp[<span class="st">'population'</span>] <span class="op">/</span> df_grouped_nbjepdp[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le DataFrame groupé avec les proportions</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'NBJDEPDP'</span>)</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_nbjepdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________________________
NBJDEPDP
________________________________________________________________________________________________
                  taux_risque  population  proportion
decile                                               
(-0.001, 2.0]        2.901558      381726   91.488791
(2.0, 3.0]          14.653397        2914    0.698402
(3.0, 5.0]          14.759929        5061    1.212977
(5.0, 9.0]          20.037175        2690    0.644716
(9.0, 21.0]         21.216441        4209    1.008777
(21.0, 27.0]        27.029077        3955    0.947900
(27.0, 35.0]        24.181818        4400    1.054554
(35.0, 61.0]        32.863316        4397    1.053835
(61.0, 117.63]      40.479397        3713    0.889900
(117.63, 3161.0]    24.514738        4173    1.000149</code></pre>
</div>
</div>
<div id="831d11bf-0d2f-495c-8025-82f80398ccc3" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>discret_NBJ_ARR_6dm <span class="op">=</span> discret.copy()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>discret_NBJ_ARR_6dm[<span class="st">'decile'</span>] <span class="op">=</span> pd.qcut(discret_NBJ_ARR_6dm[<span class="st">'NBJ_ARR_6dm'</span>], <span class="dv">100</span>, labels<span class="op">=</span><span class="va">None</span>, duplicates<span class="op">=</span><span class="st">'drop'</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>df_grouped_NBJ_ARR_6dm <span class="op">=</span> discret_NBJ_ARR_6dm.groupby(<span class="st">'decile'</span>).agg(</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>df_grouped_NBJ_ARR_6dm[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped_NBJ_ARR_6dm[<span class="st">'population'</span>] <span class="op">/</span> df_grouped_NBJ_ARR_6dm[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le DataFrame groupé avec les proportions</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'NBJ_ARR_6dm'</span>)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_NBJ_ARR_6dm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________________________
NBJ_ARR_6dm
________________________________________________________________________________________________
                taux_risque  population  proportion
decile                                             
(-0.001, 2.0]      3.648424      391210   93.761834
(2.0, 3.0]        10.546139        1593    0.381796
(3.0, 7.0]        14.191555        4855    1.163604
(7.0, 10.0]       17.044451        3397    0.814164
(10.0, 16.0]      18.720602        4252    1.019083
(16.0, 24.0]      23.158964        3938    0.943826
(24.0, 41.0]      25.507548        3842    0.920817
(41.0, 1185.0]    33.461816        4151    0.994876</code></pre>
</div>
</div>
<div id="4c8ac5cd" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>vars_quan_sel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>45          LIGCRE_IND_0009
30              NBJ_ARR_6dm
38            NBJDEB_NA_mm3
36           CRTOC_IND_0164
43    NB_MOIS_AVEC_ARR_12dm
31             NBJ_ARR_12dm
44          NBJDEB_IND_0015
29          DEPASSEMENT_6dm
35                NBJDEB_NA
33                 NBJDEPDP
28              DEPASSEMENT
Name: Variable, dtype: object</code></pre>
</div>
</div>
<div id="55a5a94e-ec8d-469b-8b55-522e04f133d8" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>variable_adis<span class="op">=</span> [<span class="st">'DEPASSEMENT'</span>, <span class="st">'NBJDEPDP'</span>, <span class="st">'NBJDEB_NA'</span>, <span class="st">'CRTOC_IND_0164'</span>, <span class="st">'NB_MOIS_AVEC_ARR_12dm'</span>,</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">'NBJDEB_IND_0015'</span>, <span class="st">'LIGCRE_IND_0009'</span>, <span class="st">'NBJDEB_NA_mm3'</span>, <span class="st">'NBJ_ARR_6dm'</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NBJ_ARR_12dm'</span>, <span class="st">'DEPASSEMENT_6dm'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="de837d26-54d1-4287-bfde-b414df27d6ff" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>[<span class="bu">any</span>(discret_test[col].isna()) <span class="cf">for</span> col <span class="kw">in</span> variable_adis]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>[False, False, False, False, False, False, False, True, True, True, True]</code></pre>
</div>
</div>
<div id="ae7fb8d6-74b3-4bd7-ab32-65ea32783be3" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'NBJDEB_NA_mm3'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'NBJ_ARR_6dm'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'NBJ_ARR_12dm'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'DEPASSEMENT_6dm'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6fce2eee-1e97-47b2-9b12-4c7c7ec16848" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>[<span class="bu">any</span>(discret_test[col].isna()) <span class="cf">for</span> col <span class="kw">in</span> variable_adis]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>[False, False, False, False, False, False, False, False, False, False, False]</code></pre>
</div>
</div>
<div id="22a24c28-8bbe-4053-92c5-bd0e06220b5f" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> discretisation(variable,borne,labels):</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    discret[<span class="ss">f'</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">_dis'</span>] <span class="op">=</span> pd.cut(discret[variable],</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>                         bins<span class="op">=</span>borne,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>                         labels<span class="op">=</span>labels,</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>                         right<span class="op">=</span><span class="va">False</span>) </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    discret_test[<span class="ss">f'</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">_dis'</span>] <span class="op">=</span> pd.cut(discret_test[variable],</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>                         bins<span class="op">=</span>borne,</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>                         labels<span class="op">=</span>labels,</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>                         right<span class="op">=</span><span class="va">False</span>) </span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    df_grouped <span class="op">=</span> discret.groupby(<span class="ss">f'</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">_dis'</span>).agg(</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>        taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>        population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    df_grouped[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped[<span class="st">'population'</span>] <span class="op">/</span> df_grouped[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_grouped)</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[[<span class="st">'[0,30.86]'</span>,<span class="st">'(30.86,+inf)'</span>],</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,2.0]'</span>,<span class="st">'(2.0,+inf)'</span>],</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,3]'</span>,<span class="st">'(3,19.0)'</span>,<span class="st">'(19.0,+inf)'</span>],</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'(-inf,16600.0]'</span>, <span class="st">'(16600.0,+inf)'</span>],</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,1.0]'</span>,<span class="st">'(1.0,+inf)'</span>],</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,4.0]'</span>, <span class="st">'(4.0,20.0]'</span>, <span class="st">'(20.0,+inf)'</span>],</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,3447892.2]'</span>,<span class="st">'(3447892.2,+inf]'</span>],</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'(-inf,12.0]'</span>,<span class="st">'(12.0,+inf]'</span>],</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,1.0]'</span>,<span class="st">'(1.0,+inf]'</span>],</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,2.0]'</span>,<span class="st">'(2.0,+inf]'</span>],</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'[0,106.68]'</span>,<span class="st">'(106.68,+inf]'</span>]</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>       ]</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>borne<span class="op">=</span>[[<span class="dv">0</span>,<span class="fl">30.86</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>,<span class="fl">2.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>,<span class="fl">3.0</span>,<span class="fl">19.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="fl">16600.0</span>, <span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>,<span class="fl">1.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>,<span class="fl">4.0</span>,<span class="fl">20.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>,<span class="fl">3447892.2</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>),<span class="fl">12.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">0</span>,<span class="fl">1.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">0</span>,<span class="fl">2.0</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)],</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">0</span>,<span class="fl">106.68</span>,<span class="bu">float</span>(<span class="st">'inf'</span>)]</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(variable_adis)):</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>    discretisation(variable_adis[i], borne[i],labels[i])</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>discret_column <span class="op">=</span> [col<span class="op">+</span><span class="bu">str</span>(<span class="st">'_dis'</span>) <span class="cf">for</span> col <span class="kw">in</span> variable_adis]</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a><span class="co">###########################################################################################################</span></span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 taux_risque  population  proportion
DEPASSEMENT_dis                                     
[0,30.86]           3.180834      396374   94.999497
(30.86,+inf)       34.403758       20864    5.000503
              taux_risque  population  proportion
NBJDEPDP_dis                                     
[0,2.0]          2.831789      379654   90.992192
(2.0,+inf)      24.039485       37584    9.007808
               taux_risque  population  proportion
NBJDEB_NA_dis                                     
[0,3]             1.936700      328497   78.731324
(3,19.0)          8.784617       47014   11.267909
(19.0,+inf)      22.273348       41727   10.000767
                    taux_risque  population  proportion
CRTOC_IND_0164_dis                                     
(-inf,16600.0]        11.030499      125153    29.99559
(16600.0,+inf)         2.047692      292085    70.00441
                           taux_risque  population  proportion
NB_MOIS_AVEC_ARR_12dm_dis                                     
[0,1.0]                       3.143610      370943   88.904414
(1.0,+inf)                   17.550491       46295   11.095586
                     taux_risque  population  proportion
NBJDEB_IND_0015_dis                                     
[0,4.0]                 1.769801      288846   69.228114
(4.0,20.0]              6.903157       44371   10.634458
(20.0,+inf)            13.819164       84021   20.137428
                     taux_risque  population  proportion
LIGCRE_IND_0009_dis                                     
[0,3447892.2]          12.911034       83448   20.000096
(3447892.2,+inf]        2.699901      333790   79.999904
                   taux_risque  population  proportion
NBJDEB_NA_mm3_dis                                     
(-inf,12.0]           3.235492      373668   89.557519
(12.0,+inf]          17.663530       43570   10.442481
                 taux_risque  population  proportion
NBJ_ARR_6dm_dis                                     
[0,1.0]             3.515224      385011   92.276111
(1.0,+inf]         19.399882       32227    7.723889
                  taux_risque  population  proportion
NBJ_ARR_12dm_dis                                     
[0,2.0]              3.209441      374894   89.851356
(2.0,+inf]          18.311921       42344   10.148644
                     taux_risque  population  proportion
DEPASSEMENT_6dm_dis                                     
[0,106.68]              3.477909      375513   89.999712
(106.68,+inf]          16.119832       41725   10.000288</code></pre>
</div>
</div>
<div id="b564e44e-dd15-423e-b0a6-243134ba5819" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du taux de risque moyen dans le temps pour chaque catégorie</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> colonne_dis <span class="kw">in</span> discret_column:</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    df_time_series <span class="op">=</span> discret.groupby([<span class="st">'date'</span>, colonne_dis])[<span class="st">'target_column'</span>].mean().reset_index()</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pivote le DataFrame pour avoir les dates en index et les catégories en colonnes</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    df_pivot <span class="op">=</span> df_time_series.pivot(index<span class="op">=</span><span class="st">'date'</span>, columns<span class="op">=</span>colonne_dis, values<span class="op">=</span><span class="st">'target_column'</span>)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tracer l'évolution du taux de la variable cible dans le temps pour chaque catégorie</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> category <span class="kw">in</span> df_pivot.columns:</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>        plt.plot(df_pivot.index, df_pivot[category] <span class="op">*</span> <span class="dv">100</span>, label<span class="op">=</span>category)</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'Évolution du taux de la variable cible selon </span><span class="sc">{</span>colonne_dis<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Taux de la variable cible (%)'</span>)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-79-output-11.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6cbaeb0c-01f2-4020-8c6f-123d8ae0e792" class="cell" data-scrolled="true" data-execution_count="78">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger votre DataFrame ici</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_csv('votre_fichier.csv')</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialiser un dictionnaire pour contenir les statistiques</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>statistiques_variables <span class="op">=</span> {}</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variable <span class="kw">in</span> numerical_columns:</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>    statistiques_variables[variable] <span class="op">=</span> {}</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> valeur_cible <span class="kw">in</span> [<span class="dv">0</span>, <span class="dv">1</span>]:</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>        groupe <span class="op">=</span> base_travail[base_travail[target_column] <span class="op">==</span> valeur_cible]</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculer les statistiques pour le groupe actuel</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>        statistiques <span class="op">=</span> {</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Moyenne'</span>: groupe[variable].mean(),</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Médiane'</span>: groupe[variable].median(),</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Q1'</span>: groupe[variable].quantile(<span class="fl">0.25</span>),</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Q3'</span>: groupe[variable].quantile(<span class="fl">0.75</span>),</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Valeurs manquantes'</span>: groupe[variable].isna().<span class="bu">sum</span>()</span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ajouter les statistiques au dictionnaire</span></span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>        statistiques_variables[variable][valeur_cible] <span class="op">=</span> statistiques</span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a><span class="co"># # Afficher les statistiques</span></span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="co"># for variable, stats in statistiques_variables.items():</span></span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(f"{variable}:")</span></span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     for valeur_cible, valeurs in stats.items():</span></span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(f"  Cible={valeur_cible}: {valeurs}")</span></span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     print()  # Pour un meilleur formatage dans l'affichage</span></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7c818ac7-668a-45e4-841a-3438e6b0ff6d" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une liste pour stocker les données du DataFrame</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Parcourir chaque variable et ses statistiques</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variable, stats <span class="kw">in</span> statistiques_variables.items():</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> valeur_cible, statistiques <span class="kw">in</span> stats.items():</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Créer une ligne avec les informations nécessaires</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> {</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Variable'</span>: variable,</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Valeur Cible'</span>: valeur_cible,</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Moyenne'</span>: statistiques[<span class="st">'Moyenne'</span>],</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Médiane'</span>: statistiques[<span class="st">'Médiane'</span>],</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Q1'</span>: statistiques[<span class="st">'Q1'</span>],</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Q3'</span>: statistiques[<span class="st">'Q3'</span>],</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Valeurs manquantes'</span>: statistiques[<span class="st">'Valeurs manquantes'</span>]</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ajouter cette ligne à la liste des données</span></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>        data.append(row)</span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer le DataFrame à partir de la liste des données</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>df_statistiques <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le DataFrame</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>df_statistiques</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Valeur Cible</th>
<th data-quarto-table-cell-role="th">Moyenne</th>
<th data-quarto-table-cell-role="th">Médiane</th>
<th data-quarto-table-cell-role="th">Q1</th>
<th data-quarto-table-cell-role="th">Q3</th>
<th data-quarto-table-cell-role="th">Valeurs manquantes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NUMTECPRS</td>
<td>0</td>
<td>6.659254e+10</td>
<td>6.430692e+10</td>
<td>3.097643e+10</td>
<td>9.925124e+10</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NUMTECPRS</td>
<td>1</td>
<td>6.616270e+10</td>
<td>6.429074e+10</td>
<td>2.995430e+10</td>
<td>9.890011e+10</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Engagement_prorat</td>
<td>0</td>
<td>9.110973e+04</td>
<td>2.187131e+04</td>
<td>3.861102e+03</td>
<td>7.546129e+04</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Engagement_prorat</td>
<td>1</td>
<td>3.155347e+04</td>
<td>3.916750e+02</td>
<td>7.027000e+01</td>
<td>2.427204e+04</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>AGE</td>
<td>0</td>
<td>4.986801e+01</td>
<td>5.000000e+01</td>
<td>5.000000e+01</td>
<td>5.000000e+01</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">261</td>
<td>NB_SALARIES_abs_mm12</td>
<td>1</td>
<td>1.060851e-01</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">262</td>
<td>EVOL_NB_SALARIE</td>
<td>0</td>
<td>1.896858e-01</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">263</td>
<td>EVOL_NB_SALARIE</td>
<td>1</td>
<td>1.060851e-01</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">264</td>
<td>NBRMMSANCCLI</td>
<td>0</td>
<td>1.473531e+02</td>
<td>1.000000e+02</td>
<td>4.100000e+01</td>
<td>2.100000e+02</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">265</td>
<td>NBRMMSANCCLI</td>
<td>1</td>
<td>1.013059e+02</td>
<td>5.400000e+01</td>
<td>2.200000e+01</td>
<td>1.370000e+02</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>266 rows × 7 columns</p>
</div>
</div>
</div>
</section>
<section id="traitement-des-variables-catégorielles-selectionnées" class="level2">
<h2 class="anchored" data-anchor-id="traitement-des-variables-catégorielles-selectionnées">Traitement des variables catégorielles selectionnées</h2>
<div id="2b9c0f3f-4a10-445b-8ccd-57e4af7f9e30" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col_cat_sel <span class="kw">in</span> vars_cat_sel:</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>   fig <span class="op">=</span> plt.figure()</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>   base_travail[col_cat_sel].value_counts(normalize<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>   fig.suptitle(col_cat_sel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-11.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-13.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-14.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-82-output-15.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b88e804f-3dfe-4e67-b1e8-a9a24bc9635b" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install xlrd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: xlrd in /opt/mamba/lib/python3.10/site-packages (2.0.1)</code></pre>
</div>
</div>
<div id="54d30412-ff7c-4792-9486-3fb20da88680" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xlrd</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>naf_corresp <span class="op">=</span>  pd.read_excel(<span class="st">"naf2008_5_niveaux.xls"</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>naf_corresp <span class="op">=</span> naf_corresp[[<span class="st">'NIV5'</span>, <span class="st">'NIV1'</span>]]</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>naf_corresp <span class="op">=</span> naf_corresp.rename(columns<span class="op">=</span>{<span class="st">'NIV5'</span>: <span class="st">'CODNAF2'</span>, <span class="st">'NIV1'</span> : <span class="st">'CODNAF2_NIV1'</span>})</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>naf_corresp[<span class="st">'CODNAF2'</span>] <span class="op">=</span> naf_corresp[<span class="st">'CODNAF2'</span>].<span class="bu">str</span>.replace(<span class="st">'.'</span>,<span class="st">''</span>, regex <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>naf_corresp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CODNAF2</th>
<th data-quarto-table-cell-role="th">CODNAF2_NIV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0111Z</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0112Z</td>
<td>A</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0113Z</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0114Z</td>
<td>A</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0115Z</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">727</td>
<td>9609Z</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">728</td>
<td>9700Z</td>
<td>T</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">729</td>
<td>9810Z</td>
<td>T</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">730</td>
<td>9820Z</td>
<td>T</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">731</td>
<td>9900Z</td>
<td>U</td>
</tr>
</tbody>
</table>

<p>732 rows × 2 columns</p>
</div>
</div>
</div>
<div id="36d6b279-2e8d-4956-9fcf-25d2d760da07" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>base_travail[<span class="st">'CODNAF2'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>527714    8121Z
324008    4690Z
464966    8621Z
136481    5610A
113310    6420Z
          ...  
370799    6820B
3560      6420Z
451641    5610A
241106    8690E
145189    4399C
Name: CODNAF2, Length: 417238, dtype: category
Categories (640, object): ['0000Z', '0111Z', '0113Z', '0114Z', ..., '9604Z', '9609Z', '9810Z', '9900Z']</code></pre>
</div>
</div>
<div id="b187b026-4dde-47aa-a897-9f7982a9e4b2" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>discret <span class="op">=</span> pd.merge(discret, naf_corresp, on<span class="op">=</span><span class="st">'CODNAF2'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>discret_test <span class="op">=</span> pd.merge(discret_test, naf_corresp, on<span class="op">=</span><span class="st">'CODNAF2'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>discret</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Type_fdc_dm</th>
<th data-quarto-table-cell-role="th">Degra_couleur_IRPRO_mm1</th>
<th data-quarto-table-cell-role="th">COULEUR_PART_MM3_M</th>
<th data-quarto-table-cell-role="th">Degra_IRPRO_continue_3dm</th>
<th data-quarto-table-cell-role="th">INDRSKITDBDF</th>
<th data-quarto-table-cell-role="th">CODETAJUR</th>
<th data-quarto-table-cell-role="th">NDB_12dm</th>
<th data-quarto-table-cell-role="th">Degra_IRPRO_mm1</th>
<th data-quarto-table-cell-role="th">CODNAF2</th>
<th data-quarto-table-cell-role="th">Degra_IRPRO_mm6</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">NBJDEB_NA_dis</th>
<th data-quarto-table-cell-role="th">CRTOC_IND_0164_dis</th>
<th data-quarto-table-cell-role="th">NB_MOIS_AVEC_ARR_12dm_dis</th>
<th data-quarto-table-cell-role="th">NBJDEB_IND_0015_dis</th>
<th data-quarto-table-cell-role="th">LIGCRE_IND_0009_dis</th>
<th data-quarto-table-cell-role="th">NBJDEB_NA_mm3_dis</th>
<th data-quarto-table-cell-role="th">NBJ_ARR_6dm_dis</th>
<th data-quarto-table-cell-role="th">NBJ_ARR_12dm_dis</th>
<th data-quarto-table-cell-role="th">DEPASSEMENT_6dm_dis</th>
<th data-quarto-table-cell-role="th">CODNAF2_NIV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>Vert_Vert</td>
<td>0</td>
<td>0</td>
<td>1300</td>
<td>0</td>
<td>0</td>
<td>8121Z</td>
<td>-3.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>(4.0,20.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>N</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>4690Z</td>
<td>0.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(-inf,16600.0]</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>G</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>Vert_Vert</td>
<td>1</td>
<td>0</td>
<td>1500</td>
<td>0</td>
<td>-1</td>
<td>8621Z</td>
<td>-1.0</td>
<td>...</td>
<td>(3,19.0)</td>
<td>(16600.0,+inf)</td>
<td>(1.0,+inf)</td>
<td>(4.0,20.0]</td>
<td>[0,3447892.2]</td>
<td>(12.0,+inf]</td>
<td>[0,1.0]</td>
<td>(2.0,+inf]</td>
<td>[0,106.68]</td>
<td>Q</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>-2</td>
<td>5610A</td>
<td>-2.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(-inf,16600.0]</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>I</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5710</td>
<td>0</td>
<td>0</td>
<td>6420Z</td>
<td>0.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417233</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>6540</td>
<td>0</td>
<td>-1</td>
<td>6820B</td>
<td>-2.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417234</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>6420Z</td>
<td>0.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417235</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>5610A</td>
<td>2.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>I</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417236</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>Vert_Vert</td>
<td>0</td>
<td>0</td>
<td>1500</td>
<td>0</td>
<td>0</td>
<td>8690E</td>
<td>0.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(-inf,16600.0]</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>[0,3447892.2]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>Q</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417237</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>4399C</td>
<td>0.0</td>
<td>...</td>
<td>[0,3]</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>F</td>
</tr>
</tbody>
</table>

<p>417238 rows × 41 columns</p>
</div>
</div>
</div>
<div id="2e2be8c5-4cd5-4f56-bc7a-3b4d66d99e3a" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">'CODNAF2_NIV1'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>21</code></pre>
</div>
</div>
<div id="c4419727-5128-4f22-a80e-c4d2082079d6" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">'CODETAJUR'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>0         1300
1         5499
2         1500
3         5499
4         5710
          ... 
417233    6540
417234    5499
417235    5499
417236    1500
417237    5499
Name: CODETAJUR, Length: 417238, dtype: category
Categories (133, object): ['1100', '1200', '1290', '1300', ..., '9240', '9260', '9300', '9900']</code></pre>
</div>
</div>
<div id="6cfd637a-7356-44ad-a939-31f8ed322c96" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> first_carac(code):</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">str</span>(code)[<span class="dv">0</span>]</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">'CODETAJUR_1car'</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(first_carac, discret[<span class="st">'CODETAJUR'</span>]))</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">'CODETAJUR_1car'</span>] <span class="op">=</span> discret[<span class="st">'CODETAJUR_1car'</span>].replace(<span class="st">'n'</span>, <span class="st">'NA'</span>)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'CODETAJUR_1car'</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(first_carac, discret_test[<span class="st">'CODETAJUR'</span>]))</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">'CODETAJUR_1car'</span>] <span class="op">=</span> discret_test[<span class="st">'CODETAJUR_1car'</span>].replace(<span class="st">'n'</span>, <span class="st">'NA'</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>discret</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Type_fdc_dm</th>
<th data-quarto-table-cell-role="th">Degra_couleur_IRPRO_mm1</th>
<th data-quarto-table-cell-role="th">COULEUR_PART_MM3_M</th>
<th data-quarto-table-cell-role="th">Degra_IRPRO_continue_3dm</th>
<th data-quarto-table-cell-role="th">INDRSKITDBDF</th>
<th data-quarto-table-cell-role="th">CODETAJUR</th>
<th data-quarto-table-cell-role="th">NDB_12dm</th>
<th data-quarto-table-cell-role="th">Degra_IRPRO_mm1</th>
<th data-quarto-table-cell-role="th">CODNAF2</th>
<th data-quarto-table-cell-role="th">Degra_IRPRO_mm6</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">CRTOC_IND_0164_dis</th>
<th data-quarto-table-cell-role="th">NB_MOIS_AVEC_ARR_12dm_dis</th>
<th data-quarto-table-cell-role="th">NBJDEB_IND_0015_dis</th>
<th data-quarto-table-cell-role="th">LIGCRE_IND_0009_dis</th>
<th data-quarto-table-cell-role="th">NBJDEB_NA_mm3_dis</th>
<th data-quarto-table-cell-role="th">NBJ_ARR_6dm_dis</th>
<th data-quarto-table-cell-role="th">NBJ_ARR_12dm_dis</th>
<th data-quarto-table-cell-role="th">DEPASSEMENT_6dm_dis</th>
<th data-quarto-table-cell-role="th">CODNAF2_NIV1</th>
<th data-quarto-table-cell-role="th">CODETAJUR_1car</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>Vert_Vert</td>
<td>0</td>
<td>0</td>
<td>1300</td>
<td>0</td>
<td>0</td>
<td>8121Z</td>
<td>-3.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>(4.0,20.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>N</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>4690Z</td>
<td>0.0</td>
<td>...</td>
<td>(-inf,16600.0]</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>G</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>Vert_Vert</td>
<td>1</td>
<td>0</td>
<td>1500</td>
<td>0</td>
<td>-1</td>
<td>8621Z</td>
<td>-1.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>(1.0,+inf)</td>
<td>(4.0,20.0]</td>
<td>[0,3447892.2]</td>
<td>(12.0,+inf]</td>
<td>[0,1.0]</td>
<td>(2.0,+inf]</td>
<td>[0,106.68]</td>
<td>Q</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>-2</td>
<td>5610A</td>
<td>-2.0</td>
<td>...</td>
<td>(-inf,16600.0]</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>I</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5710</td>
<td>0</td>
<td>0</td>
<td>6420Z</td>
<td>0.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>K</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417233</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>6540</td>
<td>0</td>
<td>-1</td>
<td>6820B</td>
<td>-2.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>L</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417234</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>6420Z</td>
<td>0.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>K</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417235</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>5610A</td>
<td>2.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>I</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417236</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>Vert_Vert</td>
<td>0</td>
<td>0</td>
<td>1500</td>
<td>0</td>
<td>0</td>
<td>8690E</td>
<td>0.0</td>
<td>...</td>
<td>(-inf,16600.0]</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>[0,3447892.2]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>Q</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417237</td>
<td>4- Aucun FDC spcifique</td>
<td>0</td>
<td>NC_NC</td>
<td>0</td>
<td>0</td>
<td>5499</td>
<td>0</td>
<td>0</td>
<td>4399C</td>
<td>0.0</td>
<td>...</td>
<td>(16600.0,+inf)</td>
<td>[0,1.0]</td>
<td>[0,4.0]</td>
<td>(3447892.2,+inf]</td>
<td>(-inf,12.0]</td>
<td>[0,1.0]</td>
<td>[0,2.0]</td>
<td>[0,106.68]</td>
<td>F</td>
<td>5</td>
</tr>
</tbody>
</table>

<p>417238 rows × 42 columns</p>
</div>
</div>
</div>
<div id="b7488002-3b1b-4fbf-89a6-4d7fa7c98019" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>unique(<span class="bu">list</span>(discret[<span class="st">'CODETAJUR_1car'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>array(['1', '2', '3', '5', '6', '7', '8', '9', 'NA'], dtype='&lt;U2')</code></pre>
</div>
</div>
<div id="ab8e027a-108e-464e-ab6c-d0ae28b2fc0f" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>vars_cat_sel <span class="op">=</span> vars_cat_sel.replace(<span class="st">'CODNAF2'</span>,<span class="st">'CODNAF2_NIV1'</span>).replace(<span class="st">'CODETAJUR'</span>, <span class="st">'CODETAJUR_1car'</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> vars_cat_sel:</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    discret[col] <span class="op">=</span> discret[col].astype(<span class="st">'category'</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( discret[col].dtypes)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>vars_cat_sel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>category
category
category
category
category
category
category
category
category
category
category
category
category
category
category</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>3                  Type_fdc_dm
14     Degra_couleur_IRPRO_mm1
1           COULEUR_PART_MM3_M
11    Degra_IRPRO_continue_3dm
15                INDRSKITDBDF
2               CODETAJUR_1car
16                    NDB_12dm
12             Degra_IRPRO_mm1
0                 CODNAF2_NIV1
4              Degra_IRPRO_mm6
13             Degra_IRPRO_mm3
7                CHR_USAGE_mm6
6                CHR_USAGE_mm3
5                CHR_USAGE_mm1
17           classe_finale_NDB
Name: Variable, dtype: object</code></pre>
</div>
</div>
<div id="9c38647c-5f9a-430d-9338-688d3991b9e9" class="cell" data-scrolled="true" data-execution_count="90">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> vars_cat_sel:</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    df_grouped <span class="op">=</span> discret.groupby(col).agg(</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>        taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>        population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    df_grouped[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped[<span class="st">'population'</span>] <span class="op">/</span> df_grouped[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Afficher le DataFrame groupé avec les proportions</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(col)</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________________________
Type_fdc_dm
________________________________________________________________________________________________
                        taux_risque  population  proportion
Type_fdc_dm                                                
1- Recouvrement           17.165006         903    0.216423
2- Rseau - Amiable        28.009828        1221    0.292639
3- Rseau - GDDS           26.353791         277    0.066389
4- Aucun FDC spcifique     4.632181      414837   99.424549
________________________________________________________________________________________________
Degra_couleur_IRPRO_mm1
________________________________________________________________________________________________
                         taux_risque  population  proportion
Degra_couleur_IRPRO_mm1                                     
 0                          4.150630      364788   87.429237
 1                          5.549893       19622    4.702831
 2                          6.049149         529    0.126786
 3                         27.272727          22    0.005273
-1                         10.484910       29490    7.067908
-2                         15.285253        2787    0.667964
________________________________________________________________________________________________
COULEUR_PART_MM3_M
________________________________________________________________________________________________
                    taux_risque  population  proportion
COULEUR_PART_MM3_M                                     
NC_NC                  5.154995      309719   74.230775
NC_NN                  9.137056         197    0.047215
NC_Orange              4.280156         257    0.061596
NC_Rouge               6.034483         116    0.027802
NC_Vert                3.157895          95    0.022769
NN_NC                  6.451613          62    0.014860
NN_NN                  2.272727          44    0.010546
NN_Orange              4.878049          82    0.019653
NN_Rouge              11.320755         106    0.025405
NN_Vert                0.000000          27    0.006471
Noir_NC               20.000000          20    0.004793
Noir_Orange           31.132075         106    0.025405
Noir_Rouge            17.616580         193    0.046257
Noir_Vert             25.641026          39    0.009347
Orange_NC              8.633094         139    0.033314
Orange_Orange          4.588309       22274    5.338440
Orange_Rouge          10.549376        2967    0.711105
Orange_Vert            2.884211        4750    1.138439
Rouge_NC              17.567568          74    0.017736
Rouge_Orange           8.520971        2265    0.542856
Rouge_Rouge           11.986479        7692    1.843552
Rouge_Vert             7.096774         155    0.037149
Vert_NC                6.818182          88    0.021091
Vert_Orange            3.836514        5187    1.243175
Vert_Rouge             9.486166         253    0.060637
Vert_Vert              1.370771       60331   14.459613
________________________________________________________________________________________________
Degra_IRPRO_continue_3dm
________________________________________________________________________________________________
                          taux_risque  population  proportion
Degra_IRPRO_continue_3dm                                     
0                            4.415215      404918   97.047249
1                           15.487013       12320    2.952751
________________________________________________________________________________________________
INDRSKITDBDF
________________________________________________________________________________________________
              taux_risque  population  proportion
INDRSKITDBDF                                     
.                0.000000          38    0.009108
0                4.570074      413757   99.165704
1               25.471972        3443    0.825189
________________________________________________________________________________________________
CODETAJUR_1car
________________________________________________________________________________________________
                taux_risque  population  proportion
CODETAJUR_1car                                     
1                  3.832603      123467   29.591504
2                  3.529412         170    0.040744
3                  6.334842         221    0.052967
5                  5.143015      239101   57.305662
6                  3.723877       44980   10.780418
7                 20.000000          15    0.003595
8                  9.904153         313    0.075017
9                 11.507892        8933    2.140984
NA                 0.000000          38    0.009108
________________________________________________________________________________________________
NDB_12dm
________________________________________________________________________________________________
          taux_risque  population  proportion
NDB_12dm                                     
.            5.511811        2032    0.487012
0            4.530086      411692   98.670783
1           29.140581        3514    0.842205
________________________________________________________________________________________________
Degra_IRPRO_mm1
________________________________________________________________________________________________
                 taux_risque  population  proportion
Degra_IRPRO_mm1                                     
 .                 11.881751        5277    1.264746
 0                  3.501032      290800   69.696432
 1                  5.858431       35163    8.427564
 2                  2.356683       12263    2.939090
 3                  2.141582        3362    0.805775
 4                  3.291139         395    0.094670
 5                  1.408451          71    0.017017
 6                  0.000000           8    0.001917
-1                  8.929154       42938   10.291009
-2                  9.675554       17291    4.144158
-3                 10.185054        7079    1.696634
-4                 12.700965        1866    0.447227
-5                  9.752066         605    0.145001
-6                 16.814159         113    0.027083
-7                  0.000000           7    0.001678
________________________________________________________________________________________________
CODNAF2_NIV1
________________________________________________________________________________________________
              taux_risque  population  proportion
CODNAF2_NIV1                                     
A                4.963748        5379    1.304360
B                1.886792          53    0.012852
C                4.403476       17032    4.130111
D                5.454545         220    0.053348
E                3.684211         380    0.092147
F                6.560551       39768    9.643392
G                4.859510       67229   16.302445
H                4.860443       20780    5.038968
I                5.052060       38321    9.292508
J                6.687898        8478    2.055841
K                4.598201       13788    3.343469
L                4.060570       47284   11.465957
M                4.327700       45151   10.948723
N                6.566298       16539    4.010563
O                0.000000          24    0.005820
P                4.021879        6216    1.507326
Q                2.152012       59061   14.321776
R                6.139892        5733    1.390202
S                7.046226       20919    5.072675
T                0.000000           6    0.001455
U                8.000000          25    0.006062
________________________________________________________________________________________________
Degra_IRPRO_mm6
________________________________________________________________________________________________
                 taux_risque  population  proportion
Degra_IRPRO_mm6                                     
-8.0               31.250000         128    0.032706
-7.0               26.896552         870    0.222301
-6.0               18.352539        2343    0.598680
-5.0               13.999569        4643    1.186373
-4.0               12.373155        8672    2.215857
-3.0                9.341212       15908    4.064789
-2.0                8.165296       26135    6.677978
-1.0                6.922198       48135   12.299386
 0.0                2.430016      206048   52.649089
 1.0                3.703621       44902   11.473294
 2.0                2.250788       20304    5.188049
 3.0                1.746497        9562    2.443268
 4.0                1.858045        2691    0.687600
 5.0                2.141058         794    0.202882
 6.0                2.020202         198    0.050593
 7.0                0.000000          27    0.006899
 8.0                0.000000           1    0.000256
________________________________________________________________________________________________
Degra_IRPRO_mm3
________________________________________________________________________________________________
                 taux_risque  population  proportion
Degra_IRPRO_mm3                                     
 .                 12.373860       14369    3.443838
 0                  2.777686      241388   57.853791
 1                  4.463369       42860   10.272315
 2                  2.326637       17622    4.223489
 3                  1.949733        6565    1.573442
 4                  3.418803        1287    0.308457
 5                  1.948052         308    0.073819
 6                  4.615385          65    0.015579
 7                  0.000000          13    0.003116
 8                  0.000000           2    0.000479
-1                  7.671885       47459   11.374563
-2                  9.120680       22597    5.415854
-3                 11.401749       12463    2.987024
-4                 15.051105        6066    1.453846
-5                 15.975422        2604    0.624104
-6                 20.086207        1160    0.278019
-7                 27.945205         365    0.087480
-8                 26.666667          45    0.010785
________________________________________________________________________________________________
CHR_USAGE_mm6
________________________________________________________________________________________________
               taux_risque  population  proportion
CHR_USAGE_mm6                                     
 .               10.253332       24158    5.789981
 1                0.689192      107227   25.699241
 2                1.347011       62583   14.999353
 3                2.117459       45054   10.798154
 4                3.377744       31974    7.663252
 5                4.583462       38988    9.344307
 6                6.203356       23181    5.555822
 7                7.948482       35793    8.578557
 8               12.286894       33434    8.013172
 9               21.521802       10343    2.478921
10               26.005747        2784    0.667245
11               33.079179        1705    0.408640
91                7.142857          14    0.003355
________________________________________________________________________________________________
CHR_USAGE_mm3
________________________________________________________________________________________________
               taux_risque  population  proportion
CHR_USAGE_mm3                                     
 .                9.958442       12994    3.114290
 1                0.550378      106654   25.561910
 2                1.065292       61861   14.826310
 3                1.675310       44350   10.629425
 4                2.858123       32049    7.681228
 5                4.350907       39509    9.469176
 6                6.152388       24267    5.816105
 7                7.913225       38859    9.313389
 8               12.622883       38858    9.313150
 9               22.568424       12934    3.099909
10               28.117914        3528    0.845561
11               35.307018        1368    0.327870
91               14.285714           7    0.001678
________________________________________________________________________________________________
CHR_USAGE_mm1
________________________________________________________________________________________________
               taux_risque  population  proportion
CHR_USAGE_mm1                                     
 .                8.695652        4715    1.130050
 1                0.376421      105467   25.277420
 2                0.780031       60895   14.594788
 3                1.259268       43835   10.505994
 4                2.128133       31436    7.534309
 5                3.403557       39635    9.499374
 6                4.668767       24439    5.857328
 7                7.077945       40054    9.599797
 8               12.863606       44210   10.595871
 9               25.211126       16933    4.058355
10               35.297607        5057    1.212018
11               38.750000         560    0.134216
91                0.000000           2    0.000479
________________________________________________________________________________________________
classe_finale_NDB
________________________________________________________________________________________________
                   taux_risque  population  proportion
classe_finale_NDB                                     
 1                    0.165782       36192    8.674186
 2                    0.298698       67292   16.127965
 3                    0.514426       60067   14.396340
 4                    0.909216       43554   10.438647
 5                    1.566892       30953    7.418548
 6                    2.522769       21960    5.263183
 7                    3.005365       16404    3.931569
 8                    3.726236       23670    5.673021
 9                    5.432743       21849    5.236580
10                    6.567213       18501    4.434160
12                    9.294872       21528    5.159645
13                   12.794992       15975    3.828750
14                   16.153184       11620    2.784981
15                   25.918542       17555    4.207431
16                   28.395062        3807    0.912429
17                   39.056769        5725    1.372119
18                   36.689420         586    0.140447</code></pre>
</div>
</div>
<div id="7a352e7c" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>discret[vars_cat_sel].columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>Index(['Type_fdc_dm', 'Degra_couleur_IRPRO_mm1', 'COULEUR_PART_MM3_M',
       'Degra_IRPRO_continue_3dm', 'INDRSKITDBDF', 'CODETAJUR_1car',
       'NDB_12dm', 'Degra_IRPRO_mm1', 'CODNAF2_NIV1', 'Degra_IRPRO_mm6',
       'Degra_IRPRO_mm3', 'CHR_USAGE_mm6', 'CHR_USAGE_mm3', 'CHR_USAGE_mm1',
       'classe_finale_NDB'],
      dtype='object')</code></pre>
</div>
</div>
<div id="21f43206" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>unique(discret[<span class="st">"Type_fdc_dm"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>array(['1- Recouvrement', '2- Rseau - Amiable', '3- Rseau - GDDS',
       '4- Aucun FDC spcifique'], dtype=object)</code></pre>
</div>
</div>
<div id="49fb3375" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_type_fdc(value):</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> [<span class="st">"2- Rseau - Amiable"</span>, <span class="st">"3- Rseau - GDDS"</span>, <span class="st">'1- Recouvrement'</span>]: </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'1_2_3- Recouvrement ou Rseau'</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'4- Aucun FDC spcifique'</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_degra_couleur_irpro_mm1(value):</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">int</span>(value)</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">0</span>) <span class="kw">or</span> value<span class="op">==</span><span class="dv">3</span>:</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'-2_-1 ou 3'</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  </span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'0_2'</span></span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_indr_ndb12(value):</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">int</span>(value)</span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-28"><a href="#cb154-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb154-29"><a href="#cb154-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'1'</span></span>
<span id="cb154-30"><a href="#cb154-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> :</span>
<span id="cb154-31"><a href="#cb154-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'None_0'</span></span>
<span id="cb154-32"><a href="#cb154-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-33"><a href="#cb154-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_degra_irpro(value):</span>
<span id="cb154-34"><a href="#cb154-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb154-35"><a href="#cb154-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb154-36"><a href="#cb154-36" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">int</span>(value)</span>
<span id="cb154-37"><a href="#cb154-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb154-38"><a href="#cb154-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb154-39"><a href="#cb154-39" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb154-40"><a href="#cb154-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">9</span>):</span>
<span id="cb154-41"><a href="#cb154-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'0_8'</span></span>
<span id="cb154-42"><a href="#cb154-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-43"><a href="#cb154-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb154-44"><a href="#cb154-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'None_-8_-1'</span></span>
<span id="cb154-45"><a href="#cb154-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-46"><a href="#cb154-46" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"Type_fdc_dm_bin"</span>] <span class="op">=</span> discret[<span class="st">"Type_fdc_dm"</span>].<span class="bu">apply</span>(recode_type_fdc)</span>
<span id="cb154-47"><a href="#cb154-47" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"Degra_IRPRO_continue_3dm_bin"</span>] <span class="op">=</span> discret[<span class="st">"Degra_IRPRO_continue_3dm"</span>]</span>
<span id="cb154-48"><a href="#cb154-48" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"Degra_couleur_IRPRO_mm1_bin"</span>] <span class="op">=</span> discret[<span class="st">"Degra_couleur_IRPRO_mm1"</span>].<span class="bu">apply</span>(recode_degra_couleur_irpro_mm1)</span>
<span id="cb154-49"><a href="#cb154-49" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"INDRSKITDBDF_bin"</span>] <span class="op">=</span> discret[<span class="st">"INDRSKITDBDF"</span>].<span class="bu">apply</span>(recode_indr_ndb12)</span>
<span id="cb154-50"><a href="#cb154-50" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"NDB_12dm_bin"</span>] <span class="op">=</span> discret[<span class="st">"NDB_12dm"</span>].<span class="bu">apply</span>(recode_indr_ndb12)</span>
<span id="cb154-51"><a href="#cb154-51" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"Degra_IRPRO_mm1_bin"</span>] <span class="op">=</span> discret[<span class="st">"Degra_IRPRO_mm1"</span>].<span class="bu">apply</span>(recode_degra_irpro)</span>
<span id="cb154-52"><a href="#cb154-52" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"Degra_IRPRO_mm3_bin"</span>] <span class="op">=</span> discret[<span class="st">"Degra_IRPRO_mm3"</span>].<span class="bu">apply</span>(recode_degra_irpro)</span>
<span id="cb154-53"><a href="#cb154-53" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"Degra_IRPRO_mm6_bin"</span>] <span class="op">=</span> discret[<span class="st">"Degra_IRPRO_mm6"</span>].<span class="bu">apply</span>(recode_degra_irpro)</span>
<span id="cb154-54"><a href="#cb154-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-55"><a href="#cb154-55" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"Type_fdc_dm_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"Type_fdc_dm"</span>].<span class="bu">apply</span>(recode_type_fdc)</span>
<span id="cb154-56"><a href="#cb154-56" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"Degra_IRPRO_continue_3dm_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"Degra_IRPRO_continue_3dm"</span>]</span>
<span id="cb154-57"><a href="#cb154-57" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"Degra_couleur_IRPRO_mm1_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"Degra_couleur_IRPRO_mm1"</span>].<span class="bu">apply</span>(recode_degra_couleur_irpro_mm1)</span>
<span id="cb154-58"><a href="#cb154-58" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"INDRSKITDBDF_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"INDRSKITDBDF"</span>].<span class="bu">apply</span>(recode_indr_ndb12)</span>
<span id="cb154-59"><a href="#cb154-59" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"NDB_12dm_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"NDB_12dm"</span>].<span class="bu">apply</span>(recode_indr_ndb12)</span>
<span id="cb154-60"><a href="#cb154-60" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"Degra_IRPRO_mm1_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"Degra_IRPRO_mm1"</span>].<span class="bu">apply</span>(recode_degra_irpro)</span>
<span id="cb154-61"><a href="#cb154-61" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"Degra_IRPRO_mm3_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"Degra_IRPRO_mm3"</span>].<span class="bu">apply</span>(recode_degra_irpro)</span>
<span id="cb154-62"><a href="#cb154-62" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"Degra_IRPRO_mm6_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"Degra_IRPRO_mm6"</span>].<span class="bu">apply</span>(recode_degra_irpro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c0587324-e52f-44d5-9fef-38d59e5247ca" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_value(value):</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">int</span>(value)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>, <span class="dv">12</span>):  <span class="co"># Checks if value is between 1 and 5</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'9_11'</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> value <span class="op">==</span> <span class="dv">8</span>:  <span class="co"># Checks if value is 8</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'8'</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># For all other values including '.', 91, 9, 10, 11</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'NA_91_1_7'</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_classe_fin(value):</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">int</span>(value)</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">9</span>):  <span class="co"># Checks if value is between 1 and 5</span></span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'1_8'</span></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>, <span class="dv">15</span>):  </span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'9_14'</span></span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  </span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'15_18'</span></span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_codetajur(value):</span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">int</span>(value)</span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">7</span>, <span class="dv">10</span>):  <span class="co"># Checks if value is between 7 and 9</span></span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'7_9'</span></span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  </span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'NA_1_6'</span></span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recode_naf(value):</span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to integer if possible</span></span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">str</span>(value)</span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb155-50"><a href="#cb155-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If conversion fails, set value to None</span></span>
<span id="cb155-51"><a href="#cb155-51" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb155-52"><a href="#cb155-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb155-53"><a href="#cb155-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value <span class="kw">in</span> [<span class="st">"F"</span>, <span class="st">"J"</span>, <span class="st">"N"</span>, <span class="st">"S"</span>, <span class="st">"U"</span>]: </span>
<span id="cb155-54"><a href="#cb155-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'F_J_N_S_U'</span></span>
<span id="cb155-55"><a href="#cb155-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  </span>
<span id="cb155-56"><a href="#cb155-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Autres'</span></span>
<span id="cb155-57"><a href="#cb155-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-58"><a href="#cb155-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-59"><a href="#cb155-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-60"><a href="#cb155-60" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"classe_NDB_bin"</span>] <span class="op">=</span> discret[<span class="st">"classe_finale_NDB"</span>].<span class="bu">apply</span>(recode_classe_fin)</span>
<span id="cb155-61"><a href="#cb155-61" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"CODNAF2_NIV1_bin"</span>] <span class="op">=</span> discret[<span class="st">"CODNAF2_NIV1"</span>].<span class="bu">apply</span>(recode_naf)</span>
<span id="cb155-62"><a href="#cb155-62" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"CODETAJUR_1car_bin"</span>] <span class="op">=</span> discret[<span class="st">"CODETAJUR_1car"</span>].<span class="bu">apply</span>(recode_codetajur)</span>
<span id="cb155-63"><a href="#cb155-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-64"><a href="#cb155-64" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"classe_NDB_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"classe_finale_NDB"</span>].<span class="bu">apply</span>(recode_classe_fin)</span>
<span id="cb155-65"><a href="#cb155-65" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"CODNAF2_NIV1_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"CODNAF2_NIV1"</span>].<span class="bu">apply</span>(recode_naf)</span>
<span id="cb155-66"><a href="#cb155-66" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"CODETAJUR_1car_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"CODETAJUR_1car"</span>].<span class="bu">apply</span>(recode_codetajur)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d9c39883-0bc4-4359-bb79-cea7d1dcd225" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>discret[<span class="st">"CODNAF2_NIV1_bin"</span>] <span class="op">=</span> discret[<span class="st">"CODNAF2_NIV1_bin"</span>].fillna(<span class="st">'Autres'</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>discret_test[<span class="st">"CODNAF2_NIV1_bin"</span>] <span class="op">=</span> discret_test[<span class="st">"CODNAF2_NIV1_bin"</span>].fillna(<span class="st">'Autres'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="036ff641-7dca-424c-ae6b-60edcb71eaab" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Appliquer la fonction de recodage à la colonne catégorielle</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">'CHR_USAGE_mm1'</span>, <span class="st">'CHR_USAGE_mm3'</span>,<span class="st">'CHR_USAGE_mm6'</span>]:</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    discret[col<span class="op">+</span><span class="bu">str</span>(<span class="st">'_rec'</span>)] <span class="op">=</span> discret[col].<span class="bu">apply</span>(recode_value)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    discret_test[col<span class="op">+</span><span class="bu">str</span>(<span class="st">'_rec'</span>)] <span class="op">=</span> discret_test[col].<span class="bu">apply</span>(recode_value)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(discret[col<span class="op">+</span><span class="bu">str</span>(<span class="st">'_rec'</span>)] )</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>cat_rec_column <span class="op">=</span>[col<span class="op">+</span><span class="bu">str</span>(<span class="st">'_rec'</span>) <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">'CHR_USAGE_mm1'</span>, <span class="st">'CHR_USAGE_mm3'</span>,<span class="st">'CHR_USAGE_mm6'</span>]]<span class="op">+</span>[<span class="st">'classe_NDB_bin'</span>, </span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="st">'CODNAF2_NIV1_bin'</span>,<span class="st">'CODETAJUR_1car_bin'</span>, <span class="st">"Type_fdc_dm_bin"</span>, <span class="st">"Degra_IRPRO_continue_3dm_bin"</span>, <span class="st">"Degra_couleur_IRPRO_mm1_bin"</span>,</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a> <span class="st">"INDRSKITDBDF_bin"</span>, <span class="st">"NDB_12dm_bin"</span>, <span class="st">"Degra_IRPRO_mm1_bin"</span>, <span class="st">"Degra_IRPRO_mm3_bin"</span>, <span class="st">"Degra_IRPRO_mm6_bin"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0         NA_91_1_7
1         NA_91_1_7
2         NA_91_1_7
3         NA_91_1_7
4         NA_91_1_7
            ...    
417233    NA_91_1_7
417234    NA_91_1_7
417235    NA_91_1_7
417236    NA_91_1_7
417237    NA_91_1_7
Name: CHR_USAGE_mm1_rec, Length: 417238, dtype: object
0         NA_91_1_7
1         NA_91_1_7
2         NA_91_1_7
3         NA_91_1_7
4         NA_91_1_7
            ...    
417233    NA_91_1_7
417234    NA_91_1_7
417235    NA_91_1_7
417236    NA_91_1_7
417237    NA_91_1_7
Name: CHR_USAGE_mm3_rec, Length: 417238, dtype: object
0         NA_91_1_7
1         NA_91_1_7
2         NA_91_1_7
3         NA_91_1_7
4         NA_91_1_7
            ...    
417233    NA_91_1_7
417234    NA_91_1_7
417235    NA_91_1_7
417236    NA_91_1_7
417237    NA_91_1_7
Name: CHR_USAGE_mm6_rec, Length: 417238, dtype: object</code></pre>
</div>
</div>
<div id="a3694cb9-09c0-42fc-ac73-731305dac027" class="cell" data-scrolled="true" data-execution_count="97">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> colonne_dis <span class="kw">in</span> cat_rec_column:</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>    df_time_series <span class="op">=</span> discret.groupby([<span class="st">'date'</span>, colonne_dis])[<span class="st">'target_column'</span>].mean().reset_index()</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pivote le DataFrame pour avoir les dates en index et les catégories en colonnes</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    df_pivot <span class="op">=</span> df_time_series.pivot(index<span class="op">=</span><span class="st">'date'</span>, columns<span class="op">=</span>colonne_dis, values<span class="op">=</span><span class="st">'target_column'</span>)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tracer l'évolution du taux de la variable cible dans le temps pour chaque catégorie</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> category <span class="kw">in</span> df_pivot.columns:</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>        plt.plot(df_pivot.index, df_pivot[category] <span class="op">*</span> <span class="dv">100</span>, label<span class="op">=</span>category)</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'Évolution du taux de la variable cible selon </span><span class="sc">{</span>colonne_dis<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Taux de la variable cible (%)'</span>)</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-11.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-13.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-99-output-14.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="validation-des-nouvelles-variables" class="level4">
<h4 class="anchored" data-anchor-id="validation-des-nouvelles-variables">Validation des nouvelles variables</h4>
<div id="9c141abe" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(vars_cat_sel))</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(cat_rec_column))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>15
14</code></pre>
</div>
</div>
<div id="67781329" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(discret_column))</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(vars_quan_sel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>11
11</code></pre>
</div>
</div>
<div id="07f426b7" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(discret_column))</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(vars_quan_sel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>11
11</code></pre>
</div>
</div>
<div id="fb5277f0" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>discret_column</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>['DEPASSEMENT_dis',
 'NBJDEPDP_dis',
 'NBJDEB_NA_dis',
 'CRTOC_IND_0164_dis',
 'NB_MOIS_AVEC_ARR_12dm_dis',
 'NBJDEB_IND_0015_dis',
 'LIGCRE_IND_0009_dis',
 'NBJDEB_NA_mm3_dis',
 'NBJ_ARR_6dm_dis',
 'NBJ_ARR_12dm_dis',
 'DEPASSEMENT_6dm_dis']</code></pre>
</div>
</div>
<div id="660e965a" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>cat_rec_column</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>['CHR_USAGE_mm1_rec',
 'CHR_USAGE_mm3_rec',
 'CHR_USAGE_mm6_rec',
 'classe_NDB_bin',
 'CODNAF2_NIV1_bin',
 'CODETAJUR_1car_bin',
 'Type_fdc_dm_bin',
 'Degra_IRPRO_continue_3dm_bin',
 'Degra_couleur_IRPRO_mm1_bin',
 'INDRSKITDBDF_bin',
 'NDB_12dm_bin',
 'Degra_IRPRO_mm1_bin',
 'Degra_IRPRO_mm3_bin',
 'Degra_IRPRO_mm6_bin']</code></pre>
</div>
</div>
<div id="8200efc6" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>new_variables <span class="op">=</span> cat_rec_column <span class="op">+</span> discret_column </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(new_variables))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25</code></pre>
</div>
</div>
<div id="118d7786" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>cat_df <span class="op">=</span> discret[new_variables]</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculez la matrice de corrélation basée sur le V de Cramer</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>corr_matrix_cat <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>cat_df.columns, columns<span class="op">=</span>cat_df.columns, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> cat_df.columns:</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> cat_df.columns:</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> j:</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>            confusion_matrix_cat <span class="op">=</span> pd.crosstab(cat_df[i], cat_df[j])</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>            corr_matrix_cat.loc[i, j] <span class="op">=</span> cramers_v(confusion_matrix_cat)</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Créez une carte de chaleur (heatmap) basée sur le V de Cramer</span></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix_cat, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez un titre</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matrice de Corrélation (V de Cramer)'</span>)</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichez le graphique</span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-106-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3839aef8" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>seuil_corr <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>variable_pairs_cat_inacceptable <span class="op">=</span> []</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(corr_matrix_cat.columns)):</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(corr_matrix_cat.columns)):</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(corr_matrix_cat.iloc[i, j]) <span class="op">&gt;</span> seuil_corr:</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>            variable_pairs_cat_inacceptable.append((discret[new_variables].columns[i], discret[new_variables].columns[j]))</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichez les paires de variables corrélées</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Paires de variables avec des corrélations inacceptables :"</span>)</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_cat_inacceptable:</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Paires de variables avec des corrélations inacceptables :
('NB_MOIS_AVEC_ARR_12dm_dis', 'NBJ_ARR_6dm_dis')
('NB_MOIS_AVEC_ARR_12dm_dis', 'NBJ_ARR_12dm_dis')
('NB_MOIS_AVEC_ARR_12dm_dis', 'DEPASSEMENT_6dm_dis')
('NBJ_ARR_6dm_dis', 'NBJ_ARR_12dm_dis')
('NBJ_ARR_6dm_dis', 'DEPASSEMENT_6dm_dis')</code></pre>
</div>
</div>
<div id="cc1ee3bc" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>vars_suppr_cat <span class="op">=</span>[]</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>Chi2test <span class="op">=</span> chi_squared_test(discret,target[target_column],new_variables).sort_values(by <span class="op">=</span><span class="st">'Chi2'</span>,ascending <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> variable_pairs_cat_inacceptable:</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">float</span>(Chi2test[<span class="st">'V de Cramer'</span>][Chi2test[<span class="st">'Variable'</span>]<span class="op">==</span>pair[<span class="dv">0</span>]]) <span class="op">&lt;</span> <span class="bu">float</span>(Chi2test[<span class="st">'V de Cramer'</span>][Chi2test[<span class="st">'Variable'</span>]<span class="op">==</span>pair[<span class="dv">1</span>]]):</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>        vars_suppr_cat.append(pair[<span class="dv">0</span>])</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>        vars_suppr_cat.append(pair[<span class="dv">1</span>])</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>vars_suppr_cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>['NBJ_ARR_6dm_dis',
 'NBJ_ARR_12dm_dis',
 'DEPASSEMENT_6dm_dis',
 'NBJ_ARR_6dm_dis',
 'DEPASSEMENT_6dm_dis']</code></pre>
</div>
</div>
<div id="7f9d1a99" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>new_variables_decorr <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> new_variables <span class="cf">if</span> var <span class="kw">not</span> <span class="kw">in</span> vars_suppr_cat]</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(new_variables_decorr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22</code></pre>
</div>
</div>
<div id="cac1fa1d" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>base_test3_chi2<span class="op">=</span> chi_squared_test(discret,target[target_column],new_variables_decorr).sort_values(by <span class="op">=</span><span class="st">'V de Cramer'</span>,ascending <span class="op">=</span> <span class="va">True</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>plt.barh(base_test3_chi2[<span class="st">'Variable'</span>], base_test3_chi2[<span class="st">'V de Cramer'</span>])</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajoutez des étiquettes et un titre</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'V de Cramer'</span>)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variable'</span>)</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variables catégorielles dépendantes de la variable cible'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>Text(0.5, 1.0, 'Variables catégorielles dépendantes de la variable cible')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="projet28Janvier_files/figure-html/cell-110-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="507fc7d5" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On élimine certaines variables selon la logique métier</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># il s'agit de ne garder une seule variable dérivée d'un même indicatur</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>variables_sel <span class="op">=</span> [<span class="st">"CODNAF2_NIV1_bin"</span>, <span class="st">"Degra_IRPRO_continue_3dm_bin"</span>, <span class="st">"LIGCRE_IND_0009_dis"</span>, <span class="st">"CRTOC_IND_0164_dis"</span>,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"NB_MOIS_AVEC_ARR_12dm_dis"</span>, <span class="st">"Type_fdc_dm_bin"</span>, <span class="st">"CHR_USAGE_mm1_rec"</span>, <span class="st">"classe_NDB_bin"</span>, <span class="st">"NBJDEB_IND_0015_dis"</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"NBJDEB_NA_mm3_dis"</span>, <span class="st">"CODETAJUR_1car_bin"</span>, <span class="st">"DEPASSEMENT_dis"</span>, <span class="st">"INDRSKITDBDF_bin"</span>,<span class="st">"date"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sélection-des-variables-pour-le-modèle" class="level3">
<h3 class="anchored" data-anchor-id="sélection-des-variables-pour-le-modèle">Sélection des variables pour le modèle</h3>
<div id="8a5438f2" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>discret[variables_sel<span class="op">+</span>[<span class="st">'target_column'</span>]].to_csv(<span class="st">'regression_logistique.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>discret_test[variables_sel<span class="op">+</span>[<span class="st">'target_column'</span>]].to_csv(<span class="st">'regression_logistique_test.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">sum</span>(discret_test[<span class="st">'target_column'</span>].isnull()))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">sum</span>(discret[<span class="st">'target_column'</span>].isnull()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0
0</code></pre>
</div>
</div>
<div id="875c22b3-53b9-4bf7-8b5d-08dbbae7f7f8" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>discret[[<span class="st">"CODNAF2"</span>, <span class="st">"CODNAF2_NIV1"</span>, <span class="st">"CODNAF2_NIV1_bin"</span>]][discret[<span class="st">"CODNAF2_NIV1"</span>].isna()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CODNAF2</th>
<th data-quarto-table-cell-role="th">CODNAF2_NIV1</th>
<th data-quarto-table-cell-role="th">CODNAF2_NIV1_bin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">73</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">163</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">416954</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">416989</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417031</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417078</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417103</td>
<td>0000Z</td>
<td>NaN</td>
<td>Autres</td>
</tr>
</tbody>
</table>

<p>4852 rows × 3 columns</p>
</div>
</div>
</div>
<div id="e26e4fdc-2961-48ca-8c3f-b384756c7f42" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(discret[<span class="st">"CODNAF2_NIV1_bin"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>{'Autres', 'F_J_N_S_U'}</code></pre>
</div>
</div>
<div id="842a9c13-548c-4f72-be8d-f8f3dfddcb74" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> [<span class="st">'NBJ_ARR_6dm'</span>,<span class="st">'NBJDEB_NA_mm3'</span>,<span class="st">'NBJ_ARR_12dm'</span>,<span class="st">'DEPASSEMENT_3dm'</span>,<span class="st">'DEPASSEMENT_6dm'</span> ]</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> test:</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>    discret[<span class="st">'decile'</span>] <span class="op">=</span> pd.qcut(discret[col], <span class="dv">20</span>, labels<span class="op">=</span><span class="va">None</span>, duplicates<span class="op">=</span><span class="st">'drop'</span>)</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>    df_grouped <span class="op">=</span> discret.groupby(<span class="st">'decile'</span>).agg(</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>        taux_risque<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="kw">lambda</span> x: x.mean()<span class="op">*</span><span class="dv">100</span>),       <span class="co"># Calcul du taux de risque</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>        population<span class="op">=</span>(<span class="st">'target_column'</span>, <span class="st">'size'</span>) </span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul de la proportion de la population pour chaque décile</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>    df_grouped[<span class="st">'proportion'</span>] <span class="op">=</span> df_grouped[<span class="st">'population'</span>] <span class="op">/</span> df_grouped[<span class="st">'population'</span>].<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Afficher le DataFrame groupé avec les proportions</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(col)</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"________________________________________________________________________________________________"</span>)</span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_grouped)</span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________________________
NBJ_ARR_6dm
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-0.001, 7.0]     3.804777      397658   95.307235
(7.0, 1185.0]    23.779367       19580    4.692765
________________________________________________________________________________________________
NBJDEB_NA_mm3
________________________________________________________________________________________________
               taux_risque  population  proportion
decile                                            
(-2.001, 0.0]     2.665967      327836   78.572901
(0.0, 1.0]        5.175639        9622    2.306118
(1.0, 5.0]        6.782294       19315    4.629252
(5.0, 12.0]       9.284271       18806    4.507260
(12.0, 29.0]     13.969480       21232    5.088702
(29.0, 92.0]     22.156949       20427    4.895767
________________________________________________________________________________________________
NBJ_ARR_12dm
________________________________________________________________________________________________
                taux_risque  population  proportion
decile                                             
(-0.001, 2.0]      3.281001      379244   90.893926
(2.0, 13.0]       13.076789       17229    4.129298
(13.0, 1185.0]    24.512401       20765    4.976776</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>KeyError: 'DEPASSEMENT_3dm'</code></pre>
</div>
</div>
<div id="3b5ce8ef-7648-4f13-834b-b6588c0df88f" class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>base_travail[test].isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="eef167fe-6de7-4246-8758-a3a84b7e0aa2" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supposons que base_travail est votre DataFrame</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 'target' est le nom de votre variable cible</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 'test' est la liste des noms de colonnes où vous voulez vérifier les valeurs manquantes</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> test:</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lignes avec des valeurs manquantes dans la colonne actuelle</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    missing <span class="op">=</span> discret[discret[col].isna()]</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul du taux de risque (proportion où la variable cible est 1)</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    taux_risque <span class="op">=</span> missing[<span class="st">'target_column'</span>].mean()  <span class="co"># mean() sur une série binaire donne la proportion de 1</span></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Affichage du taux de risque pour la colonne actuelle</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Taux de risque pour </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>taux_risque<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8f2aaee7-96e3-425d-88e9-368e80afaaf7" class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>base_travail[test].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9dc69796-8389-4a4d-a389-32e6ad0aebae" class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co">select_num_column = [col for col in vars_quan_sel if col not in variable_dis]</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co">cat_rec_column=cat_rec_column+discret_column</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co">cat_rec_column</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="241dc696-3f7e-47c5-b5a8-6d3b1409e2b5" class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select_num_column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="144dc46b-469e-4832-b8c9-7d7663666d60" class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculez la matrice de corrélation</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>correlation_matrix_quan <span class="op">=</span> base_reg[select_num_column].corr()</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))  <span class="co"># You can adjust the size of the figure</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix_quan, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">".2f"</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Feature Correlation Heatmap'</span>)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="89e4d0f6-9631-4ccf-b106-2745b56fb0ce" class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>base_reg <span class="op">=</span> discret[[<span class="st">'cible_1'</span>,<span class="st">'date'</span>]<span class="op">+</span>variable_dis<span class="op">+</span>cat_rec_column]</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>base_reg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="27933798-c711-4a74-a176-09fc2ee50f0b" class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>base_reg[<span class="st">'cible_1'</span>].astype(<span class="bu">int</span>).mean()<span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6c107cb4-92c8-497f-a0c1-51e34a39de0d" class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d'une nouvelle colonne 'stratify_col' qui combine la variable cible et la date</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Supposons que 'target' est votre variable cible et 'date' est votre variable de date</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="co">#X['stratify_col'] = base_reg['cible_1'].astype(str) + '_' + base_reg['date'].astype(str)</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> base_reg[cat_rec_column]</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cat_rec_column:</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>    dummies <span class="op">=</span> pd.get_dummies(X[col], prefix<span class="op">=</span>col)</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> pd.concat([X, dummies], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>    X.drop(col, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> base_reg[<span class="st">'cible_1'</span>]</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>X[<span class="st">'stratify_col'</span>] <span class="op">=</span> base_reg[<span class="st">'cible_1'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> base_reg[<span class="st">'date'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Split train-test stratifié en utilisant la colonne combinée</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>    X,  <span class="co"># Les features incluant la date si elle est utilisée comme feature</span></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>    y,                 <span class="co"># La variable cible</span></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>    stratify<span class="op">=</span>X[<span class="st">'stratify_col'</span>],  <span class="co"># La nouvelle colonne pour la stratification</span></span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.3</span>,                <span class="co"># La proportion de l'ensemble de test</span></span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>               <span class="co"># La graine pour la reproductibilité</span></span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Vous pouvez ensuite supprimer la colonne 'stratify_col' si elle n'est pas nécessaire pour l'entraînement</span></span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> X_train.drop([<span class="st">'stratify_col'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test.drop([<span class="st">'stratify_col'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="24658ab0-0720-4c11-b374-9ba95a4e8974" class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>y_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0038aa54-6816-463e-90bd-b1d4bfdcd23f" class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour scikit-learn</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pas besoin d'ajouter une colonne constante, scikit-learn le fait automatiquement</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Création du modèle de régression logistique avec scikit-learn</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>logistic_model <span class="op">=</span> LogisticRegression()</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>logistic_model.fit(X_train, y_train)</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Vous pouvez maintenant utiliser logistic_model pour prédire ou évaluer la performance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d94c4e23-883c-44f7-a726-b87d05c0b1a5" class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>predicted_target <span class="op">=</span> logistic_model.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="55bfb234-7c38-447f-8eea-7d01e3d39235" class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> logistic_model.score(X_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="77bc9c96-906e-4ab4-afa4-8fb9e84dd432" class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d2a3a076-3d80-45da-a8d0-1b28bc33dbc4" class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir les coefficients du modèle</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="op">=</span> logistic_model.coef_[<span class="dv">0</span>]</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer un DataFrame pour une meilleure lisibilité</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> X_train.columns</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>coefs_with_features <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(<span class="bu">zip</span>(feature_names, coefficients)), columns<span class="op">=</span>[<span class="st">'Feature'</span>, <span class="st">'Coefficient'</span>])</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Trier les caractéristiques par l'importance du coefficient (absolu)</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>coefs_with_features[<span class="st">'abs'</span>] <span class="op">=</span> coefs_with_features[<span class="st">'Coefficient'</span>].<span class="bu">abs</span>()</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>coefs_with_features <span class="op">=</span> coefs_with_features.sort_values(by<span class="op">=</span><span class="st">'abs'</span>, ascending<span class="op">=</span><span class="va">False</span>).drop(<span class="st">'abs'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coefs_with_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1cc920ab-567a-49d5-815f-ddfe9a979811" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> X_train.astype(<span class="bu">int</span>)</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> y_train.astype(<span class="st">'int'</span>)</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter une colonne constante pour le terme d'interception</span></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>X_train_sm <span class="op">=</span> sm.add_constant(X_train)</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer et ajuster le modèle de régression logistique avec statsmodels</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y_train, X_train_sm)</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> logit_model.fit()</span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le résumé qui inclut les p-values</span></span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9be02183-55ae-492e-a9a3-8c9572aee6cb" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>X_train.select_dtypes(include<span class="op">=</span><span class="st">"object"</span>).columns</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>y_train.select_dtypes(include<span class="op">=</span><span class="st">"object"</span>).columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6937a037-3f33-453e-8b54-f12bedbb77c6" class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectKBest</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> chi2</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare input data</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_inputs(X_train, X_test):</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>    oe <span class="op">=</span> OrdinalEncoder()</span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>    oe.fit(X_train)</span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>    X_train_enc <span class="op">=</span> oe.transform(X_train)</span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>    X_test_enc <span class="op">=</span> oe.transform(X_test)</span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X_train_enc, X_test_enc</span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare target</span></span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_targets(y_train, y_test):</span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a>    le.fit(y_train)</span>
<span id="cb207-22"><a href="#cb207-22" aria-hidden="true" tabindex="-1"></a>    y_train_enc <span class="op">=</span> le.transform(y_train)</span>
<span id="cb207-23"><a href="#cb207-23" aria-hidden="true" tabindex="-1"></a>    y_test_enc <span class="op">=</span> le.transform(y_test)</span>
<span id="cb207-24"><a href="#cb207-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y_train_enc, y_test_enc</span>
<span id="cb207-25"><a href="#cb207-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-26"><a href="#cb207-26" aria-hidden="true" tabindex="-1"></a><span class="co"># feature selection</span></span>
<span id="cb207-27"><a href="#cb207-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-28"><a href="#cb207-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_features(X_train, y_train, X_test):</span>
<span id="cb207-29"><a href="#cb207-29" aria-hidden="true" tabindex="-1"></a>    fs <span class="op">=</span> SelectKBest(score_func<span class="op">=</span>chi2, k<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb207-30"><a href="#cb207-30" aria-hidden="true" tabindex="-1"></a>    fs.fit(X_train, y_train)</span>
<span id="cb207-31"><a href="#cb207-31" aria-hidden="true" tabindex="-1"></a>    X_train_fs <span class="op">=</span> fs.transform(X_train)</span>
<span id="cb207-32"><a href="#cb207-32" aria-hidden="true" tabindex="-1"></a>    X_test_fs <span class="op">=</span> fs.transform(X_test)</span>
<span id="cb207-33"><a href="#cb207-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X_train_fs, X_test_fs, fs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9c7c2444-cf70-455c-b576-79a30c509555" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co">##### </span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>X_train_enc, X_test_enc <span class="op">=</span> prepare_inputs(X_train, X_test)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare output data</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>y_train_enc, y_test_enc <span class="op">=</span> prepare_targets(y_train, y_test)</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="co"># feature selection</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>B, X_test_fs, fs <span class="op">=</span> select_features(X_train_enc, y_train_enc, X_test_enc)</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="co"># what are scores for the features</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fs.scores_)):</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Feature </span><span class="sc">%d</span><span class="st">: </span><span class="sc">%f</span><span class="st">'</span> <span class="op">%</span> (i, fs.scores_[i]))</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the scores</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>pyplot.bar([i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fs.scores_))], fs.scores_)</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>pyplot.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cd08acda-397e-4408-ac81-a41da8d2ad14" class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>